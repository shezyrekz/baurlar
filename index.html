<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–®–µ–∂—ñ—Ä–µ | –®–µ–∂–∏—Ä–µ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f6f1d1;
  }
  header {
    background: #26a69a;
    color: white;
    height: 55px;
    display: flex;
    align-items: center;
    padding: 0 18px;
    gap: 22px;
    position: relative;
  }
  
  /* –í–´–ë–û–† –Ø–ó–´–ö–ê - –°–ü–†–ê–í–ê –í–í–ï–†–•–£ */
  .language-selector {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    gap: 10px;
    align-items: center;
  }
  
  .lang-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    padding: 6px 15px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .lang-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-1px);
  }
  
  .lang-btn.active {
    background: rgba(255, 255, 255, 0.4);
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }
  
  .lang-flag {
    font-size: 16px;
  }
  
  header .icon {
    cursor: pointer;
    font-size: 26px;
    user-select: none;
    transition: transform 0.2s, opacity 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 5px;
    border-radius: 5px;
  }
  header .icon:hover {
    transform: scale(1.1);
    background: rgba(255, 255, 255, 0.1);
  }
  header .icon.active {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
  }
  
  /* –ö–û–ù–¢–ï–ô–ù–ï–†–´ –î–õ–Ø –†–ê–ó–ù–´–• –°–ï–ö–¶–ò–ô */
  .section {
    display: none;
    width: 100%;
    height: calc(100vh - 55px);
    padding: 20px;
    box-sizing: border-box;
    overflow: auto;
  }
  
  .section.active {
    display: block;
  }
  
  /* –°–ï–ö–¶–ò–Ø –õ–Æ–î–ò (–î–ï–†–ï–í–û) */
  #people-section {
    background: #f6f1d1;
  }
  
  /* –°–ï–ö–¶–ò–Ø –ü–û–ò–°–ö */
  #search-section {
    background: #f6f1d1;
  }
  
  .search-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
  }
  
  .search-box {
    width: 100%;
    padding: 15px;
    font-size: 16px;
    border: 2px solid #26a69a;
    border-radius: 25px;
    margin-bottom: 20px;
    box-sizing: border-box;
  }
  
  .search-results {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .result-item {
    padding: 10px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .result-item:hover {
    background: #f0f9f7;
    transform: translateX(5px);
  }
  
  /* –°–ï–ö–¶–ò–Ø –î–û–ë–ê–í–ò–¢–¨ */
  #add-section {
    background: #f6f1d1;
  }
  
  .add-form {
    max-width: 500px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .form-group {
    margin-bottom: 20px;
  }
  
  .form-group label {
    display: block;
    margin-bottom: 5px;
    color: #333;
    font-weight: bold;
  }
  
  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 10px;
    border: 2px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
    box-sizing: border-box;
  }
  
  .form-group textarea {
    height: 100px;
    resize: vertical;
  }
  
  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    border-color: #26a69a;
    outline: none;
  }
  
  .submit-btn {
    background: #26a69a;
    color: white;
    border: none;
    padding: 12px 30px;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
    width: 100%;
  }
  
  .submit-btn:hover {
    background: #1e887c;
  }
  
  /* –°–ï–ö–¶–ò–Ø –ó–ê–Ø–í–ö–ò */
  #requests-section {
    background: #f6f1d1;
  }
  
  .requests-container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .request-item {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 15px;
    background: #f9f9f9;
  }
  
  .request-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  
  .request-name {
    font-weight: bold;
    font-size: 18px;
    color: #26a69a;
  }
  
  .request-date {
    font-size: 12px;
    color: #888;
  }
  
  .request-details {
    margin: 10px 0;
    color: #555;
  }
  
  .request-parent {
    font-style: italic;
    color: #666;
  }
  
  .request-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
  }
  
  .action-btn {
    padding: 8px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }
  
  .approve-btn {
    background: #4CAF50;
    color: white;
  }
  
  .reject-btn {
    background: #f44336;
    color: white;
  }
  
  /* –°–ï–ö–¶–ò–Ø –ü–û–ú–û–©–¨ */
  #help-section {
    background: #f6f1d1;
  }
  
  .help-content {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  
  .help-item {
    margin-bottom: 25px;
  }
  
  .help-item h3 {
    color: #26a69a;
    margin-bottom: 10px;
  }
  
  /* –°–ï–ö–¶–ò–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
  #stats-section {
    background: #f6f1d1;
  }
  
  .stats-container {
    max-width: 800px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
  }
  
  .stat-card {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    text-align: center;
  }
  
  .stat-number {
    font-size: 36px;
    font-weight: bold;
    color: #26a69a;
    margin: 10px 0;
  }
  
  .stat-label {
    color: #666;
    font-size: 14px;
  }
  
  /* –°–¢–ò–õ–ò –î–õ–Ø –î–ï–†–ï–í–ê */
  #tree-container {
    width: 100%;
    height: 100%;
    cursor: move;
  }
  
  .node-group {
    cursor: pointer;
  }
  
  /* –û–í–ê–õ–¨–ù–´–ï –ö–ê–†–¢–û–ß–ö–ò (–ú–ï–ù–¨–®–ï) –° –ö–†–£–ñ–ö–û–ú –£ –õ–ï–í–û–ì–û –ö–†–ê–Ø */
  .node-card {
    fill: #8fbc8f; /* –°–í–ï–¢–õ–û-–ó–ï–õ–ï–ù–´–ô –ö–ê–ö –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ */
    stroke: #789d78;
    stroke-width: 2px;
    rx: 25px;  /* –û–≤–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ */
    ry: 25px;
    filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
    transition: all 0.3s ease;
  }
  
  .node-card:hover {
    filter: drop-shadow(3px 3px 6px rgba(0,0,0,0.3));
    fill: #a8d4a8; /* –°–≤–µ—Ç–ª–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
  }
  
  .node-card.selected {
    fill: #ffffff; /* –ë–ï–õ–´–ô –ø—Ä–∏ –≤—ã–±–æ—Ä–µ */
    stroke: #26a69a;
    stroke-width: 3px;
    filter: drop-shadow(4px 4px 8px rgba(0,0,0,0.4));
  }
  
  .node-card.highlighted {
    fill: #ffeb3b; /* –ñ–ï–õ–¢–´–ô –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ */
    stroke: #ff9800;
    stroke-width: 3px;
    animation: pulse 1.5s infinite;
  }
  
  @keyframes pulse {
    0% { filter: drop-shadow(0 0 5px rgba(255, 152, 0, 0.5)); }
    50% { filter: drop-shadow(0 0 15px rgba(255, 152, 0, 0.8)); }
    100% { filter: drop-shadow(0 0 5px rgba(255, 152, 0, 0.5)); }
  }
  
  .node-card.collapsed {
    fill: #8fbc8f; /* –û–±—ã—á–Ω—ã–π –∑–µ–ª–µ–Ω—ã–π */
    stroke: #789d78;
  }
  
  .node-card.expanded {
    fill: #8fbc8f; /* –û–±—ã—á–Ω—ã–π –∑–µ–ª–µ–Ω—ã–π */
    stroke: #789d78;
  }
  
  .node-image-container {
    clip-path: circle(50% at 50% 50%);
  }
  
  .node-image {
    pointer-events: none;
    user-select: none;
  }
  
  .node-text {
    font-size: 14px;
    pointer-events: none;
    user-select: none;
    fill: white;
    font-weight: 600;
    text-anchor: middle;
    dominant-baseline: central;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  }
  
  /* –í–ï–¢–ö–ò - –ß–ï–†–ù–´–ï –ò –í–ò–î–ò–ú–´–ï */
  .link {
    fill: none;
    stroke: #696969; /* –ß–ï–†–ù–´–ô –¶–í–ï–¢ */
    stroke-width: 2px;
    opacity: 1; /* –ü–û–õ–ù–ê–Ø –í–ò–î–ò–ú–û–°–¢–¨ */
    transition: opacity 0.3s;
  }
  
  .link:hover {
    opacity: 1;
    stroke-width: 3px;
    stroke: #333333; /* –¢–µ–º–Ω–µ–µ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
  }
  
  .floating-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #ff9800;
    color: white;
    border-radius: 50%;
    width: 56px;
    height: 56px;
    font-size: 36px;
    line-height: 56px;
    text-align: center;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    user-select: none;
    z-index: 100;
  }
  
  .admin-btn {
    position: fixed;
    bottom: 100px;
    right: 30px;
    background: #9C27B0;
    color: white;
    border-radius: 50%;
    width: 56px;
    height: 56px;
    font-size: 20px;
    line-height: 56px;
    text-align: center;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    user-select: none;
    z-index: 100;
  }
  
  /* –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
  .notification {
    position: fixed;
    top: 70px;
    right: 20px;
    background: #4CAF50;
    color: white;
    padding: 15px 20px;
    border-radius: 5px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    z-index: 1001;
    display: none;
  }
  
  .notification.error {
    background: #f44336;
  }
  
  /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
  @media (max-width: 768px) {
    header {
      gap: 15px;
      padding: 0 10px;
    }
    
    .language-selector {
      position: static;
      transform: none;
      margin-left: auto;
    }
    
    .lang-btn span {
      display: none;
    }
    
    .lang-btn {
      padding: 6px 10px;
    }
    
    header .icon {
      font-size: 22px;
    }
    
    .help-content,
    .add-form,
    .search-container,
    .requests-container {
      padding: 15px;
    }
    
    .floating-btn,
    .admin-btn {
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      line-height: 50px;
      font-size: 30px;
    }
    
    .admin-btn {
      bottom: 80px;
    }
  }
</style>
</head>
<body>

<header>
  <div class="icon active" title="–õ—é–¥–∏" data-section="people"><i class="fas fa-users"></i></div>
  <div class="icon" title="–ü–æ–∏—Å–∫" data-section="search"><i class="fas fa-search"></i></div>
  <div class="icon" title="–î–æ–±–∞–≤–∏—Ç—å" data-section="add"><i class="fas fa-user-plus"></i></div>
  <div class="icon" title="–ó–∞—è–≤–∫–∏" data-section="requests"><i class="fas fa-tasks"></i></div>
  <div class="icon" title="–ü–æ–º–æ—â—å" data-section="help"><i class="fas fa-question-circle"></i></div>
  <div class="icon" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" data-section="stats"><i class="fas fa-chart-bar"></i></div>
  
  <!-- –í–´–ë–û–† –Ø–ó–´–ö–ê -->
  <div class="language-selector">
    <button class="lang-btn active" data-lang="ru">
      <span class="lang-flag">üá∑üá∫</span>
      <span>–†–£</span>
    </button>
    <button class="lang-btn" data-lang="kk">
      <span class="lang-flag">üá∞üáø</span>
      <span>“ö–ê–ó</span>
    </button>
  </div>
</header>

<!-- –°–ï–ö–¶–ò–Ø –õ–Æ–î–ò (–î–ï–†–ï–í–û) -->
<div id="people-section" class="section active">
  <div id="tree-container"></div>
  <div class="floating-btn" title="–î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª">+</div>
  <div class="admin-btn" title="–ó–∞—è–≤–∫–∏"><i class="fas fa-tasks"></i></div>
</div>

<!-- –°–ï–ö–¶–ò–Ø –ü–û–ò–°–ö -->
<div id="search-section" class="section">
  <div class="search-container">
    <input type="text" class="search-box" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∞–º...">
    <div class="search-results">
      <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h3>
      <div id="search-results-list"></div>
    </div>
  </div>
</div>

<!-- –°–ï–ö–¶–ò–Ø –î–û–ë–ê–í–ò–¢–¨ -->
<div id="add-section" class="section">
  <div class="add-form">
    <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞</h2>
    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
      <i class="fas fa-info-circle"></i> –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ
    </p>
    <div class="form-group">
      <label for="person-name">–ò–º—è:</label>
      <input type="text" id="person-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
    </div>
    <div class="form-group">
      <label for="parent-select">–†–æ–¥–∏—Ç–µ–ª—å:</label>
      <select id="parent-select">
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—è</option>
      </select>
    </div>
    <div class="form-group">
      <label for="person-info">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</label>
      <textarea id="person-info" placeholder="–ì–æ–¥—ã –∂–∏–∑–Ω–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è..."></textarea>
    </div>
    <div class="form-group">
      <label for="person-email">–í–∞—à email (–¥–ª—è –æ—Ç–≤–µ—Ç–∞):</label>
      <input type="email" id="person-email" placeholder="example@email.com">
    </div>
    <button class="submit-btn" id="submit-request-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
  </div>
</div>

<!-- –°–ï–ö–¶–ò–Ø –ó–ê–Ø–í–ö–ò (–¢–û–õ–¨–ö–û –î–õ–Ø –ê–î–ú–ò–ù–ê) -->
<div id="requests-section" class="section">
  <div class="requests-container">
    <h2>–ó–∞—è–≤–∫–∏ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</h2>
    <p id="admin-instructions" style="color: #666; margin-bottom: 20px; font-size: 14px;">
      <i class="fas fa-lock"></i> –≠—Ç–∞ —Å–µ–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    </p>
    <div id="requests-list"></div>
  </div>
</div>

<!-- –°–ï–ö–¶–ò–Ø –ü–û–ú–û–©–¨ -->
<div id="help-section" class="section">
  <div class="help-content">
    <h2>–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –®–µ–∂—ñ—Ä–µ</h2>
    
    <div class="help-item">
      <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–æ–º</h3>
      <p>‚Ä¢ –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫—Ä—É–∂–æ–∫, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å/—Å–≤–µ—Ä–Ω—É—Ç—å –≤–µ—Ç–∫—É</p>
      <p>‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "+" –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</p>
      <p>‚Ä¢ –í—Å–µ —É–∑–ª—ã –º–æ–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –ø–æ –∫–ª–∏–∫—É</p>
      <p>‚Ä¢ <strong>–ó–∞–∂–º–∏—Ç–µ –ª–µ–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –∏ –¥–≤–∏–≥–∞–π—Ç–µ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞</strong></p>
      <p>‚Ä¢ <strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–ª–µ—Å–∏–∫–æ –º—ã—à–∏ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è/—É–º–µ–Ω—å—à–µ–Ω–∏—è</strong></p>
    </div>
    
    <div class="help-item">
      <h3>üîç –ü–æ–∏—Å–∫</h3>
      <p>‚Ä¢ –í–≤–µ–¥–∏—Ç–µ –∏–º—è –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞</p>
      <p>‚Ä¢ –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —ç—Ç–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –≤ –¥–µ—Ä–µ–≤–µ</p>
      <p>‚Ä¢ –ù–∞–π–¥–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –±—É–¥–µ—Ç –ø–æ–¥—Å–≤–µ—á–µ–Ω –∂–µ–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º</p>
    </div>
    
    <div class="help-item">
      <h3>üë§ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª—é–¥–µ–π</h3>
      <p>‚Ä¢ –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –≤ —Ä–∞–∑–¥–µ–ª–µ "–î–æ–±–∞–≤–∏—Ç—å"</p>
      <p>‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—è –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤ –¥–µ—Ä–µ–≤–µ</p>
      <p>‚Ä¢ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ</p>
      <p>‚Ä¢ –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫ –ø–æ—è–≤–∏—Ç—Å—è –≤ –¥–µ—Ä–µ–≤–µ</p>
    </div>
    
    <div class="help-item">
      <h3>üìã –°–∏—Å—Ç–µ–º–∞ –∑–∞—è–≤–æ–∫</h3>
      <p>‚Ä¢ –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å –∑–∞—è–≤–∫–∏</p>
      <p>‚Ä¢ –ö–∞–∂–¥–∞—è –∑–∞—è–≤–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–æ–≤–æ–º —á–µ–ª–æ–≤–µ–∫–µ</p>
      <p>‚Ä¢ –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –¥–µ—Ä–µ–≤–æ</p>
    </div>
    
    <div class="help-item">
      <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
      <p>‚Ä¢ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∞—à–µ–≥–æ –¥–µ—Ä–µ–≤–∞</p>
      <p>‚Ä¢ –£–∑–Ω–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö</p>
      <p>‚Ä¢ –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤–µ—Ç–æ–∫ –∏ –ª–∏—Å—Ç—å–µ–≤</p>
    </div>
  </div>
</div>

<!-- –°–ï–ö–¶–ò–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
<div id="stats-section" class="section">
  <div class="stats-container">
    <div class="stat-card">
      <h3>–í—Å–µ–≥–æ –ª—é–¥–µ–π</h3>
      <div class="stat-number" id="total-people">0</div>
      <div class="stat-label">–≤ –¥–µ—Ä–µ–≤–µ</div>
    </div>
    
    <div class="stat-card">
      <h3>–£—Ä–æ–≤–Ω–µ–π</h3>
      <div class="stat-number" id="total-levels">0</div>
      <div class="stat-label">–≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞</div>
    </div>
    
    <div class="stat-card">
      <h3>–í–µ—Ç–æ–∫</h3>
      <div class="stat-number" id="total-branches">0</div>
      <div class="stat-label">–æ—Å–Ω–æ–≤–Ω—ã–µ –≤–µ—Ç–≤–∏</div>
    </div>
    
    <div class="stat-card">
      <h3>–õ–∏—Å—Ç—å–µ–≤</h3>
      <div class="stat-number" id="total-leaves">0</div>
      <div class="stat-label">–∫–æ–Ω–µ—á–Ω—ã–µ —É–∑–ª—ã</div>
    </div>
    
    <div class="stat-card">
      <h3>–ó–∞—è–≤–æ–∫</h3>
      <div class="stat-number" id="total-requests">0</div>
      <div class="stat-label">–æ–∂–∏–¥–∞—é—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è</div>
    </div>
    
    <div class="stat-card">
      <h3>–û–¥–æ–±—Ä–µ–Ω–æ</h3>
      <div class="stat-number" id="total-approved">0</div>
      <div class="stat-label">–∑–∞—è–≤–æ–∫ –ø—Ä–∏–Ω—è—Ç–æ</div>
    </div>
  </div>
</div>

<!-- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø -->
<div class="notification" id="notification"></div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
  // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
  let i = 0;
  let selectedNode = null;
  let currentLanguage = 'ru'; // 'ru' –∏–ª–∏ 'kk'
  let svg = null;
  let g = null;
  let zoom = null;
  let treeRoot = null;
  
  // –ë–ê–ó–ê –î–ê–ù–ù–´–• –í LOCALSTORAGE
  const STORAGE_KEYS = {
    REQUESTS: 'shezhire_requests',
    APPROVED: 'shezhire_approved',
    TREE: 'shezhire_tree_data',
    PASSWORD: 'shezhire_admin_password'
  };
  
  // –ü–ê–†–û–õ–¨ –ê–î–ú–ò–ù–ê (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
  const ADMIN_PASSWORD = 'admin123';
  
  // –¢–ï–ö–°–¢–´ –ù–ê –†–ê–ó–ù–´–• –Ø–ó–´–ö–ê–•
  const translations = {
    ru: {
      title: "–®–µ–∂—ñ—Ä–µ",
      header: {
        people: "–õ—é–¥–∏",
        search: "–ü–æ–∏—Å–∫",
        add: "–î–æ–±–∞–≤–∏—Ç—å",
        requests: "–ó–∞—è–≤–∫–∏",
        help: "–ü–æ–º–æ—â—å",
        stats: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
      },
      tree: {
        name: "–ê–ª–∞—à",
        addNode: "–î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª",
        requests: "–ó–∞—è–≤–∫–∏"
      },
      search: {
        placeholder: "–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∞–º...",
        results: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:",
        minChars: "–í–≤–µ–¥–∏—Ç–µ –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞",
        noResults: "–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ",
        found: "–ù–∞–π–¥–µ–Ω–æ: {count}"
      },
      add: {
        title: "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞",
        info: "–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ",
        name: "–ò–º—è:",
        namePlaceholder: "–í–≤–µ–¥–∏—Ç–µ –∏–º—è",
        parent: "–†–æ–¥–∏—Ç–µ–ª—å:",
        selectParent: "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—è",
        infoLabel: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:",
        infoPlaceholder: "–ì–æ–¥—ã –∂–∏–∑–Ω–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è...",
        email: "–í–∞—à email (–¥–ª—è –æ—Ç–≤–µ—Ç–∞):",
        emailPlaceholder: "example@email.com",
        button: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É"
      },
      requests: {
        title: "–ó–∞—è–≤–∫–∏ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ",
        adminOnly: "–≠—Ç–∞ —Å–µ–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É",
        noRequests: "–ù–µ—Ç –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞—è–≤–æ–∫",
        date: "–î–∞—Ç–∞:",
        parent: "–†–æ–¥–∏—Ç–µ–ª—å:",
        info: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:",
        email: "Email:",
        approve: "–û–¥–æ–±—Ä–∏—Ç—å",
        reject: "–û—Ç–∫–ª–æ–Ω–∏—Ç—å",
        approved: "–ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞",
        rejected: "–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞"
      },
      help: {
        title: "–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –®–µ–∂—ñ—Ä–µ",
        treeTitle: "üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–æ–º",
        treePoints: [
          "–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫—Ä—É–∂–æ–∫, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å/—Å–≤–µ—Ä–Ω—É—Ç—å –≤–µ—Ç–∫—É",
          "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É \"+\" –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è",
          "–í—Å–µ —É–∑–ª—ã –º–æ–∂–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –ø–æ –∫–ª–∏–∫—É",
          "<strong>–ó–∞–∂–º–∏—Ç–µ –ª–µ–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –∏ –¥–≤–∏–≥–∞–π—Ç–µ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞</strong>",
          "<strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–ª–µ—Å–∏–∫–æ –º—ã—à–∏ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è/—É–º–µ–Ω—å—à–µ–Ω–∏—è</strong>"
        ],
        searchTitle: "üîç –ü–æ–∏—Å–∫",
        searchPoints: [
          "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞",
          "–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —ç—Ç–æ–º—É —á–µ–ª–æ–≤–µ–∫—É –≤ –¥–µ—Ä–µ–≤–µ",
          "–ù–∞–π–¥–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –±—É–¥–µ—Ç –ø–æ–¥—Å–≤–µ—á–µ–Ω –∂–µ–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º"
        ],
        addTitle: "üë§ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª—é–¥–µ–π",
        addPoints: [
          "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –≤ —Ä–∞–∑–¥–µ–ª–µ \"–î–æ–±–∞–≤–∏—Ç—å\"",
          "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—è –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤ –¥–µ—Ä–µ–≤–µ",
          "–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ",
          "–ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫ –ø–æ—è–≤–∏—Ç—Å—è –≤ –¥–µ—Ä–µ–≤–µ"
        ],
        requestsTitle: "üìã –°–∏—Å—Ç–µ–º–∞ –∑–∞—è–≤–æ–∫",
        requestsPoints: [
          "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å –∑–∞—è–≤–∫–∏",
          "–ö–∞–∂–¥–∞—è –∑–∞—è–≤–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–æ–≤–æ–º —á–µ–ª–æ–≤–µ–∫–µ",
          "–ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –¥–µ—Ä–µ–≤–µ"
        ],
        statsTitle: "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
        statsPoints: [
          "–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∞—à–µ–≥–æ –¥–µ—Ä–µ–≤–∞",
          "–£–∑–Ω–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö",
          "–°–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤–µ—Ç–æ–∫ –∏ –ª–∏—Å—Ç—å–µ–≤"
        ]
      },
      stats: {
        totalPeople: "–í—Å–µ–≥–æ –ª—é–¥–µ–π",
        totalPeopleLabel: "–≤ –¥–µ—Ä–µ–≤–µ",
        levels: "–£—Ä–æ–≤–Ω–µ–π",
        levelsLabel: "–≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞",
        branches: "–í–µ—Ç–æ–∫",
        branchesLabel: "–æ—Å–Ω–æ–≤–Ω—ã–µ –≤–µ—Ç–≤–∏",
        leaves: "–õ–∏—Å—Ç—å–µ–≤",
        leavesLabel: "–∫–æ–Ω–µ—á–Ω—ã–µ —É–∑–ª—ã",
        requests: "–ó–∞—è–≤–æ–∫",
        requestsLabel: "–æ–∂–∏–¥–∞—é—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è",
        approved: "–û–¥–æ–±—Ä–µ–Ω–æ",
        approvedLabel: "–∑–∞—è–≤–æ–∫ –ø—Ä–∏–Ω—è—Ç–æ"
      },
      alerts: {
        enterName: "–í–≤–µ–¥–∏—Ç–µ –∏–º—è",
        selectParent: "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–¥–∏—Ç–µ–ª—è",
        enterEmail: "–í–≤–µ–¥–∏—Ç–µ email –¥–ª—è —Å–≤—è–∑–∏",
        requestSent: "–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –í—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π email.",
        requestError: "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏",
        approved: "–ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞ –∏ —á–µ–ª–æ–≤–µ–∫ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–µ—Ä–µ–≤–æ",
        rejected: "–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞",
        goToTree: "–ü–µ—Ä–µ—Ö–æ–¥ –∫: {name}",
        adminPassword: "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:",
        wrongPassword: "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!",
        loginSuccess: "–î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω",
        logout: "–í—ã –≤—ã—à–ª–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
      }
    },
    kk: {
      title: "–®–µ–∂—ñ—Ä–µ",
      header: {
        people: "–ê–¥–∞–º–¥–∞—Ä",
        search: "–Ü–∑–¥–µ—É",
        add: "“ö–æ—Å—É",
        requests: "”®—Ç—ñ–Ω—ñ—à—Ç–µ—Ä",
        help: "–ö”©–º–µ–∫",
        stats: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
      },
      tree: {
        name: "–ê–ª–∞—à",
        addNode: "–¢“Ø–π—ñ–Ω “õ–æ—Å—É",
        requests: "”®—Ç—ñ–Ω—ñ—à—Ç–µ—Ä"
      },
      search: {
        placeholder: "–ï—Å—ñ–º–¥–µ—Ä –±–æ–π—ã–Ω—à–∞ —ñ–∑–¥–µ—É...",
        results: "–Ü–∑–¥–µ—É –Ω”ô—Ç–∏–∂–µ–ª–µ—Ä—ñ:",
        minChars: "–ö–µ–º—ñ–Ω–¥–µ 2 —Ç–∞“£–±–∞ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑",
        noResults: "–ï—à—Ç–µ“£–µ —Ç–∞–±—ã–ª–º–∞–¥—ã",
        found: "–¢–∞–±—ã–ª–¥—ã: {count}"
      },
      add: {
        title: "–ñ–∞“£–∞ –∞–¥–∞–º–¥—ã “õ–æ—Å—É",
        info: "–°—ñ–∑–¥—ñ“£ ”©—Ç—ñ–Ω—ñ—à—ñ“£—ñ–∑ ”ô–∫—ñ–º—à—ñ–≥–µ “õ–∞—Ä–∞—É“ì–∞ –∂—ñ–±–µ—Ä—ñ–ª–µ–¥—ñ",
        name: "–ê—Ç—ã:",
        namePlaceholder: "–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑",
        parent: "–ê—Ç–∞-–∞–Ω–∞:",
        selectParent: "–ê—Ç–∞-–∞–Ω–∞—Å—ã–Ω —Ç–∞“£–¥–∞“£—ã–∑",
        infoLabel: "“ö–æ—Å—ã–º—à–∞ –∞“õ–ø–∞—Ä–∞—Ç:",
        infoPlaceholder: "”®–º—ñ—Ä —Å“Ø—Ä–≥–µ–Ω –∂—ã–ª–¥–∞—Ä—ã, –∂–µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ, —Ç“±—Ä–∞—Ç—ã–Ω –∂–µ—Ä—ñ...",
        email: "–°—ñ–∑–¥—ñ“£ email (–∂–∞—É–∞–ø “Ø—à—ñ–Ω):",
        emailPlaceholder: "example@email.com",
        button: "”®—Ç—ñ–Ω—ñ—à –∂—ñ–±–µ—Ä—É"
      },
      requests: {
        title: "“ö–æ—Å—É ”©—Ç—ñ–Ω—ñ—à—Ç–µ—Ä—ñ",
        adminOnly: "–ë“±–ª –±”©–ª—ñ–º —Ç–µ–∫ ”ô–∫—ñ–º—à—ñ–≥–µ “õ–æ–ª–∂–µ—Ç—ñ–º–¥—ñ",
        noRequests: "–ö“Ø—Ç—Ç“Ø ”©—Ç—ñ–Ω—ñ—à—Ç–µ—Ä –∂–æ“õ",
        date: "–ö“Ø–Ω—ñ:",
        parent: "–ê—Ç–∞-–∞–Ω–∞:",
        info: "–ê“õ–ø–∞—Ä–∞—Ç:",
        email: "Email:",
        approve: "–ú–∞“õ“±–ª–¥–∞—É",
        reject: "–ë–∞—Å —Ç–∞—Ä—Ç—É",
        approved: "”®—Ç—ñ–Ω—ñ—à –º–∞“õ“±–ª–¥–∞–Ω–¥—ã",
        rejected: "”®—Ç—ñ–Ω—ñ—à “õ–∞–±—ã–ª–¥–∞–Ω–±–∞–¥—ã"
      },
      help: {
        title: "–®–µ–∂—ñ—Ä–µ–Ω—ñ –ø–∞–π–¥–∞–ª–∞–Ω—É —Ç—É—Ä–∞–ª—ã –∫”©–º–µ–∫",
        treeTitle: "üë• –ê“ì–∞—à—Ç—ã –±–∞—Å“õ–∞—Ä—É",
        treePoints: [
          "–ë“±—Ç–∞“õ—Ç—ã –∂–∞—é/–∂–∞–±—É “Ø—à—ñ–Ω —à–µ“£–±–µ—Ä–¥—ñ –±–∞—Å—ã“£—ã–∑",
          "–ñ—ã–ª–¥–∞–º “õ–æ—Å—É “Ø—à—ñ–Ω —Ç”©–º–µ–Ω–≥—ñ –æ“£ –∂–∞“õ –±“±—Ä—ã—à—Ç–∞“ì—ã \"+\" —Ç“Ø–π–º–µ—Å—ñ–Ω –ø–∞–π–¥–∞–ª–∞–Ω—ã“£—ã–∑",
          "–ë–∞—Ä–ª—ã“õ —Ç“Ø–π—ñ–Ω–¥–µ—Ä–¥—ñ –±–∞—Å—É –∞—Ä“õ—ã–ª—ã –∞—à—É/–∂–∞—Å—ã—Ä—É“ì–∞ –±–æ–ª–∞–¥—ã",
          "<strong>–ê“ì–∞—à—Ç—ã –∂—ã–ª–∂—ã—Ç—É “Ø—à—ñ–Ω —Å–æ–ª —Ç“Ø–π–º–µ–Ω—ñ –±–∞—Å—ã–ø —Ç“±—Ä—ã–ø –∂—ã–ª–∂—ã—Ç—ã“£—ã–∑</strong>",
          "<strong>“Æ–ª–∫–µ–π—Ç—É/–∫—ñ—à—ñ—Ä–µ–π—Ç—É “Ø—à—ñ–Ω —Ç—ã—à“õ–∞–Ω –¥–æ“£“ì–∞–ª–∞“ì—ã–Ω –ø–∞–π–¥–∞–ª–∞–Ω—ã“£—ã–∑</strong>"
        ],
        searchTitle: "üîç –Ü–∑–¥–µ—É",
        searchPoints: [
          "–Ü–∑–¥–µ—É ”©—Ä—ñ—Å—ñ–Ω–µ –µ—Å—ñ–º –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑",
          "–ê“ì–∞—à—Ç–∞ –æ—Å—ã –∞–¥–∞–º“ì–∞ ”©—Ç—É “Ø—à—ñ–Ω –Ω”ô—Ç–∏–∂–µ–Ω—ñ –±–∞—Å—ã“£—ã–∑",
          "–¢–∞–±—ã–ª“ì–∞–Ω –∞–¥–∞–º —Å–∞—Ä—ã —Ç“Ø—Å–ø–µ–Ω –∂–∞—Ä—ã“õ—Ç–∞–ª–∞–¥—ã"
        ],
        addTitle: "üë§ –ê–¥–∞–º–¥–∞—Ä–¥—ã “õ–æ—Å—É",
        addPoints: [
          "\"“ö–æ—Å—É\" –±”©–ª—ñ–º—ñ–Ω–¥–µ–≥—ñ —Ñ–æ—Ä–º–∞–Ω—ã —Ç–æ–ª—Ç—ã—Ä—ã“£—ã–∑",
          "–ê“ì–∞—à—Ç–∞ –±–∞—Ä –∞—Ç–∞-–∞–Ω–∞–Ω—ã —Ç–∞“£–¥–∞“£—ã–∑",
          "–°—ñ–∑–¥—ñ“£ ”©—Ç—ñ–Ω—ñ—à—ñ“£—ñ–∑ ”ô–∫—ñ–º—à—ñ–≥–µ “õ–∞—Ä–∞—É“ì–∞ –∂—ñ–±–µ—Ä—ñ–ª–µ–¥—ñ",
          "–ú–∞“õ“±–ª–¥–∞–Ω“ì–∞–Ω–Ω–∞–Ω –∫–µ–π—ñ–Ω –∞–¥–∞–º –∞“ì–∞—à—Ç–∞ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã"
        ],
        requestsTitle: "üìã ”®—Ç—ñ–Ω—ñ—à—Ç–µ—Ä –∂“Ø–π–µ—Å—ñ",
        requestsPoints: [
          "–¢–µ–∫ ”ô–∫—ñ–º—à—ñ ”©—Ç—ñ–Ω—ñ—à—Ç–µ—Ä–¥—ñ –º–∞“õ“±–ª–¥–∞–π –∞–ª–∞–¥—ã",
          "”ò—Ä–±—ñ—Ä ”©—Ç—ñ–Ω—ñ—à—Ç–µ –∂–∞“£–∞ –∞–¥–∞–º —Ç—É—Ä–∞–ª—ã –∞“õ–ø–∞—Ä–∞—Ç –±–∞—Ä",
          "–ú–∞“õ“±–ª–¥–∞–Ω“ì–∞–Ω–Ω–∞–Ω –∫–µ–π—ñ–Ω –∞–¥–∞–º –∞“ì–∞—à—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç—Ç—ã —Ç“Ø—Ä–¥–µ “õ–æ—Å—ã–ª–∞–¥—ã"
        ],
        statsTitle: "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
        statsPoints: [
          "–ê“ì–∞—à—ã“£—ã–∑–¥—ã“£ –∂–∞–ª–ø—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Å—ã–Ω “õ–∞—Ä–∞“£—ã–∑",
          "”ò—Ä—Ç“Ø—Ä–ª—ñ –¥–µ“£–≥–µ–π–ª–µ—Ä–¥–µ–≥—ñ –∞–¥–∞–º–¥–∞—Ä —Å–∞–Ω—ã–Ω –±—ñ–ª—ñ“£—ñ–∑",
          "–ë“±—Ç–∞“õ—Ç–∞—Ä –º–µ–Ω –∂–∞–ø—ã—Ä–∞“õ—Ç–∞—Ä —Å–∞–Ω—ã–Ω –±–∞“õ—ã–ª–∞“£—ã–∑"
        ]
      },
      stats: {
        totalPeople: "–ë–∞—Ä–ª—ã“õ –∞–¥–∞–º–¥–∞—Ä",
        totalPeopleLabel: "–∞“ì–∞—à—Ç–∞",
        levels: "–î–µ“£–≥–µ–π–ª–µ—Ä",
        levelsLabel: "–∞“ì–∞—à —Ç–µ—Ä–µ“£–¥—ñ–≥—ñ",
        branches: "–ë“±—Ç–∞“õ—Ç–∞—Ä",
        branchesLabel: "–Ω–µ–≥—ñ–∑–≥—ñ –±“±—Ç–∞“õ—Ç–∞—Ä",
        leaves: "–ñ–∞–ø—ã—Ä–∞“õ—Ç–∞—Ä",
        leavesLabel: "—Å–æ“£“ì—ã —Ç“Ø–π—ñ–Ω–¥–µ—Ä",
        requests: "”®—Ç—ñ–Ω—ñ—à—Ç–µ—Ä",
        requestsLabel: "–∫“Ø—Ç—ñ–ø —Ç“±—Ä",
        approved: "–ú–∞“õ“±–ª–¥–∞–Ω–¥—ã",
        approvedLabel: "”©—Ç—ñ–Ω—ñ—à “õ–∞–±—ã–ª–¥–∞–Ω–¥—ã"
      },
      alerts: {
        enterName: "–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑",
        selectParent: "–ê—Ç–∞-–∞–Ω–∞—Å—ã–Ω —Ç–∞“£–¥–∞“£—ã–∑",
        enterEmail: "–ë–∞–π–ª–∞–Ω—ã—Å “Ø—à—ñ–Ω email –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑",
        requestSent: "”®—Ç—ñ–Ω—ñ—à –∂—ñ–±–µ—Ä—ñ–ª–¥—ñ! –ö”©—Ä—Å–µ—Ç—ñ–ª–≥–µ–Ω email-–≥–µ –∂–∞—É–∞–ø –∞–ª–∞—Å—ã–∑.",
        requestError: "”®—Ç—ñ–Ω—ñ—à –∂—ñ–±–µ—Ä—É –∫–µ–∑—ñ–Ω–¥–µ “õ–∞—Ç–µ –ø–∞–π–¥–∞ –±–æ–ª–¥—ã",
        approved: "”®—Ç—ñ–Ω—ñ—à –º–∞“õ“±–ª–¥–∞–Ω–¥—ã –∂”ô–Ω–µ –∞–¥–∞–º –∞“ì–∞—à“õ–∞ “õ–æ—Å—ã–ª–¥—ã",
        rejected: "”®—Ç—ñ–Ω—ñ—à “õ–∞–±—ã–ª–¥–∞–Ω–±–∞–¥—ã",
        goToTree: "”®—Ç—É: {name}",
        adminPassword: "”ò–∫—ñ–º—à—ñ–Ω—ñ“£ “õ“±–ø–∏—è —Å”©–∑—ñ–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:",
        wrongPassword: "“ö–∞—Ç–µ “õ“±–ø–∏—è —Å”©–∑!",
        loginSuccess: "–†“±“õ—Å–∞—Ç –±–µ—Ä—ñ–ª–¥—ñ",
        logout: "–°—ñ–∑ ”ô–∫—ñ–º—à—ñ —Ä–µ–∂–∏–º—ñ–Ω–µ–Ω —à—ã“õ—Ç—ã“£—ã–∑"
      }
    }
  };

  // –î–ï–¢–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –î–ê–ù–ù–´–ï –î–ï–†–ï–í–ê
  let currentTreeData = {
    name: "–ê–ª–∞—à",
    children: [
      { 
        name: "“∞–ª—ã –∂“Ø–∑",
        children: [
          { 
            name: "“ö–∞–Ω–ª—ã",
            children: [
              { 
                name: "“ö–∞–Ω–∫”©–∂–µ–∫",
                children: [
                  { 
                    name: "–ë–∞–π“õ–æ“£—ã—Ä –±–∏",
                    children: [
                      { name: "–ê“õ—ã–ª“õ–æ–∂–∞" },
                      { name: "–´—Ä“ì–∞“õ—Ç—ã" },
                      { 
                        name: "“ö“±–π—ã—Å“õ–∞–Ω–¥—ã",
                        children: [
                          { 
                            name: "–ö–µ–Ω–∂–µ–∞–ª—ã",
                            children: [
                              { name: "–ö“Ø–ª–µ—Å" },
                              { 
                                name: "–ï–º–µ–Ω–¥–µ—Å",
                                children: [
                                  { name: "–ê–π–±–∞—Å" },
                                  { name: "–õ–µ–ø–µ—Å" },
                                  { 
                                    name: "–ù–∞–∑–∞—Ä“õ“±–ª",
                                    children: [
                                      { 
                                        name: "“ö–∞–ª–º–∞–º–±–µ—Ç",
                                        children: [
                                          { 
                                            name: "–ú–∞–Ω–∞—à",
                                            children: [
                                              { name: "–ë–µ—Ä–¥–∞–ª—ã" },
                                              { name: "–°–µ—Ä–¥–∞–ª—ã" },
                                              { 
                                                name: "–°“Ø–≥—ñ—Ä",
                                                children: [
                                                  { name: "–ë–∞—É–±–µ–∫" },
                                                  { 
                                                    name: "“Æ–π—Å—ñ–Ω–±–∞–π",
                                                    children: [
                                                      { name: "–¢“Ø—Å—ñ–ø" },
                                                      { name: "–ñ“Ø–Ω—ñ—Å" },
                                                      { 
                                                        name: "“Æ—Å–µ–Ω",
                                                        children: [
                                                          { name: "–û–º–∞—Ä" },
                                                          { name: "–°—ã–¥—ã“õ" }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  { 
                                                    name: "–ê—Å“õ–∞—Ä",
                                                    children: [
                                                      { 
                                                        name: "–î–∞–±—ã–ª–¥–∞",
                                                        children: [
                                                          { name: "–ê–±–¥–∞–Ω" }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  { 
                                                    name: "–û—Ä–∞–∑–∞–ª—ã",
                                                    children: [
                                                      { 
                                                        name: "”ò—É–∑–µ–π—ñ—Ç",
                                                        children: [
                                                          { 
                                                            name: "–¢“±—Ä—Å—ã–Ω"
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              { 
                name: "–¢”ô“£—ñ—Ä–±–µ—Ä–≥–µ–Ω",
                children: [
                  { 
                    name: "–ë–∞–π—ã—Å–±–∞–π",
                    children: [
                      { name: "–ú–∞–º—ã—Ä–±–∞–π" },
                      { 
                        name: "–ú“Ø—Å—ñ—Ä–µ–ø",
                        children: [
                          { 
                            name: "–°–µ—Ä—ñ–∫–±–∞–π",
                            children: [
                              { 
                                name: "–î–æ—Å–∞–π",
                                children: [
                                  { 
                                    name: "–ë–∞—Ç—ã—Ä–±–µ–∫",
                                    children: [
                                      { name: "–¢“±—Ä–¥—ã“õ“±–ª" },
                                      { 
                                        name: "–¢“±—Ä“ì—ã–Ω",
                                        children: [
                                          { 
                                            name: "–ë–∞“õ—ã—Ç–∂–∞–Ω",
                                            children: [
                                              { name: "–ë–∞—É—ã—Ä–∂–∞–Ω" },
                                              { name: "–ú“±—Ä–∞—Ç–±–µ–∫" }
                                            ]
                                          },
                                          { 
                                            name: "–ë–µ–∫–∂–∞–Ω",
                                            children: [
                                              { name: "–ú–µ–¥–µ—É" },
                                              { name: "–ù“±—Ä–∑–∞—Ç" }
                                            ]
                                          },
                                          { 
                                            name: "–ï–ª–∂–∞–Ω",
                                            children: [
                                              { name: "–ú–µ–π—ñ—Ä–∂–∞–Ω" },
                                              { name: "–î–æ—Å—ã–º–∂–∞–Ω" },
                                              { name: "–ï–ª–º–∞—Ä" }
                                            ]
                                          }
                                        ]
                                      },
                                      { name: "–¢“±—Ä“ì—ã–Ω”ô–ª—ñ" },
                                      { name: "–®–µ—Ä–∞–ª—ã" },
                                      { name: "–ë–µ—Ä–¥–∞–ª—ã" }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      { 
                        name: "“ö–∞—Ä–∞–±–∞–ª–∞",
                        children: [
                          { 
                            name: "–¢—ã–Ω—ã—à–±–∞–π",
                            children: [
                              { name: "”ò–º—ñ—Ä–±–µ–∫" }
                            ]
                          }
                        ]
                      },
                      { 
                        name: "“ö–æ–π–±–∞“ì–∞—Ä",
                        children: [
                          { name: "“ö“±—Ä–∞–ª–±–µ–∫" },
                          { name: "–¢”©–ª–µ–≥–µ–Ω" }
                        ]
                      },
                      { 
                        name: "–ú–µ–¥–µ—Ç",
                        children: [
                          { name: "–ü–∞—Ä–Ω–∞“õ“±–ª" },
                          { name: "–¢–µ–º—ñ—Ä“õ“±–ª" },
                          { 
                            name: "–ú–∞–º—ã—Ä“õ“±–ª",
                            children: [
                              { 
                                name: "–ë–µ—Ä–¥—ñ“õ“±–ª",
                                children: [
                                  { 
                                    name: "–ñ–∞–ø–ø–∞—Ä",
                                    children: [
                                      { 
                                        name: "–ë–∞—Ç—ã—Ä",
                                        children: [
                                          { name: "–¢”©–ª–µ–≥–µ–Ω" },
                                          { name: "–†—É—Å–ª–∞–Ω" },
                                          { name: "–≠–ª–¥–∞—Ä" }
                                        ]
                                      },
                                      { 
                                        name: "–ñ”ô–Ω—ñ–±–µ–∫",
                                        children: [
                                          { name: "–î–∞–º–∏—Ä" },
                                          { name: "–ê–π–±–µ–∫" }
                                        ]
                                      },
                                      { 
                                        name: "–¢–µ–º—ñ—Ä",
                                        children: [
                                          { name: "–®—ã“£“ì—ã—Å" },
                                          { name: "–†–∞–¥–º–∏—Ä" },
                                          { name: "–°–∞–º–∏—Ä" }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              { 
                                name: "–ú“±—Ö–∞–º–º–µ–¥",
                                children: [
                                  { 
                                    name: "–°–º–∞–π—ã–ª",
                                    children: [
                                      { 
                                        name: "–ò—Å–∞",
                                        children: [
                                          { name: "”ò–ª—ñ—Ö–∞–Ω" },
                                          { name: "”ò–º—ñ—Ä—Ö–∞–Ω" },
                                          { name: "”ò—Å—ñ–ª—Ö–∞–Ω" }
                                        ]
                                      },
                                      { 
                                        name: "–ú–∞—Ä–∞—Ç",
                                        children: [
                                          { name: "–¢–µ–º—É—Ä" }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              { 
                                name: "”ò–±–¥—ñ–ª–∞",
                                children: [
                                  { 
                                    name: "–ò—Å—Ä–∞–π—ã–ª",
                                    children: [
                                      { name: "–†–∞—à–∏–¥" }
                                    ]
                                  },
                                  { 
                                    name: "–£—Å–º–∞–Ω",
                                    children: [
                                      { name: "–ù“±—Ä–ª–∞–Ω" }
                                    ]
                                  },
                                  { 
                                    name: "–°–µ–π—ñ—Ç–∂–∞–Ω",
                                    children: [
                                      { name: "–ù“±—Ä–∂–∞–Ω" }
                                    ]
                                  },
                                  { 
                                    name: "–ë–∞“õ—ã—Ç",
                                    children: [
                                      { name: "–ù“±—Ä“ì–∞–ª–∏" },
                                      { name: "–ù“±—Ä—Å“±–ª—Ç–∞–Ω" }
                                    ]
                                  }
                                ]
                              },
                              { 
                                name: "–ú–∞—Ö–º“±—Ç",
                                children: [
                                  { 
                                    name: "–ê–±–∑–∞–ª",
                                    children: [
                                      { 
                                        name: "”ò–ª—ñ“õ“±–ª",
                                        children: [
                                          { 
                                            name: "“ö—É–∞–Ω—ã—à",
                                            children: [
                                              { name: "–ù“õ–æ–∏—Å–ª–∞–º" }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              { 
                                name: "”®–º—ñ—Ä“õ“±–ª",
                                children: [
                                  { 
                                    name: "–°–µ—Ä—ñ–∫–±–∞–π",
                                    children: [
                                      { 
                                        name: "–ú–∞–ª–∏–∫",
                                        children: [
                                          { 
                                            name: "–ë–µ—Ä—ñ–∫",
                                            children: [
                                              { 
                                                name: "–î–∞–º–∏—Ä",
                                                children: [
                                                  { name: "–°–∞–º–∏—Ä" }
                                                ]
                                              }
                                            ]
                                          },
                                          { name: "–ê–±–∑–∞–ª" }
                                        ]
                                      },
                                      { 
                                        name: "–°–º–∞–¥–∏—è—Ä",
                                        children: [
                                          { 
                                            name: "–î–∞–Ω–∏—è—Ä",
                                            children: [
                                              { name: "–ê—Å“õ–∞—Ä" },
                                              { name: "–ò–±—Ä–∞—Ö–∏–º" }
                                            ]
                                          },
                                          { 
                                            name: "–ë–∞—É—ã—Ä–∂–∞–Ω",
                                            children: [
                                              { name: "–ê–π–±–∞—Ä" }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  { name: "–¢—ñ–ª–µ—Å" }
                ]
              },
              { name: "“ö–æ–∂–∞ “õ–∞–Ω–ª—ã" },
              { 
                name: "“ö–∞–π—ã “õ–∞“£–ª—ã",
                children: [
                  { name: "C“Ø–ª–µ–π–º–µ–Ω “ì–∞–∑–∏" },
                  { name: "–ï—Ä—Ç“±“ì—Ä—ã–ª “ì–∞–∑–∏" },
                  { name: "–û—Å–º–∞–Ω “ì–∞–∑–∏" }
                ]
              },
              { name: "–ñ—É—Å–∞–Ω–¥—ã" },
              { name: "–ê—à–∞–º–∞–π–ª—ã" },
              { name: "“ö–∞—Ä“õ–∞–ª—ã" },
              { name: "–ï—Ä–≥–µ–Ω–µ–∫—Ç—ñ" },
              { name: "–ë–∞–π—Ç–µ—Ä–µ–∫ –±–∞—Ç—ã—Ä" }
            ]
          },
          { name: "–®–∞–Ω—ã—à“õ—ã–ª—ã" },
          { name: "–°—ñ—Ä–≥–µ–ª—ñ" },
          { name: "–®–∞“õ—à–∞–º" },
          { name: "–°–∞—Ä—ã“Ø–π—Å—ñ–Ω" },
          { name: "–®–∞–ø—ã—Ä–∞—à—Ç—ã" },
          { name: "–ñ–∞–ª–∞–π—ã—Ä" },
          { name: "–´—Å—Ç—ã" },
          { name: "–û—à–∞“õ—Ç—ã" },
          { name: "–ê–ª–±–∞–Ω" },
          { name: "–°—É–∞–Ω" },
          { name: "–î—É–ª–∞—Ç" }
        ]
      },
      { 
        name: "–û—Ä—Ç–∞ –∂“Ø–∑",
        children: [
          { 
            name: "–ê—Ä“ì—ã–Ω",
            photo: "argyn.jpeg",
            children: [
              { 
                name: "–ú–µ–π—Ä–∞–º—Å–æ–ª—ã",
                children: [
                  { name: "“ö—É–∞–Ω–¥—ã“õ" },
                  { name: "–°“Ø–π—ñ–Ω–¥—ñ–∫" },
                  { name: "–ë–µ–≥–µ–Ω–¥—ñ–∫" },
                  { name: "–®–µ–≥–µ–Ω–¥—ñ–∫" },
                  { 
                    name: "“ö–∞—Ä–∞–∫–µ—Å–µ–∫-–ë–æ–ª–∞—Ç“õ–æ–∂–∞",
                    children: [
                      { 
                        name: "–ê“õ—à–∞",
                        children: [
                          { 
                            name: "–ë–æ—à–∞–Ω",
                            children: [
                              { name: "–¢–∞–∑" },
                              { name: "–ë–∞–π–±”©—Ä—ñ" },
                              { name: "–ú–∞—à–∞–π" },
                              { name: "–ú–∞–Ω–∞—Ç" },
                              { 
                                name: "–ñ–∞–Ω—Ç—É",
                                children: [
                                  { 
                                    name: "–ë–µ–∫—Ç–∞—É—ã–ª",
                                    children: [
                                      { name: "–¢–æ—Ä—ã" },
                                      { 
                                        name: "“ö–∞—Ä–∞–±–æ—Ç–∞",
                                        children: [
                                          { 
                                            name: "–¢–∞—Å–±–æ–ª–∞—Ç",
                                            children: [
                                              { name: "–ï–≥—ñ–∑–µ–∫" },
                                              { name: "–ñ–∞–º—ã–ª" },
                                              { 
                                                name: "–®–æ–ª–∞–Ω",
                                                children: [
                                                  { name: "“ö–∞–∂—ã“õ–∞–Ω" }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  { name: "–¢–æ“õ—Ç–∞—É—ã–ª" }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      { name: "–¢“Ø–π—Ç–µ" },
                      { name: "“ö–∞–º–±–∞—Ä"},
                      { name: "–®“±–±—ã—Ä—Ç–ø–∞–ª—ã"},
                      { 
                        name: "–ñ–∞–ª—ã“õ–ø–∞—Å",
                        children: [
                          { 
                            name: "–¢“Ø–≥–µ–ª",
                            children: [
                              { 
                                name: "–ë–∞—Ä–∞–º—ã“õ",
                                children: [
                                  { 
                                    name: "–ö“Ø–Ω—Ç—É–∞—Ä",
                                    children: [
                                      { 
                                        name: "–û—Ä–∞–∑–≥–µ–ª–¥—ñ",
                                        children: [
                                          { 
                                            name: "–ñ–æ–ª–º–∞–Ω–±–µ—Ç",
                                            children: [
                                              { 
                                                name: "–ú–∞—Ç–∞–π",
                                                children: [
                                                  { 
                                                    name: "“ö–æ—à“õ–∞—Ä",
                                                    children: [
                                                      { 
                                                        name: "–ú“Ø—Å—ñ—Ä–µ–ø",
                                                        children: [
                                                          { 
                                                            name: "–¢—ã—Ä–∞“õ",
                                                            children: [
                                                              { 
                                                                name: "–ñ–æ–ª–¥—ã–±–∞–π",
                                                                children: [
                                                                  { 
                                                                    name: "–ñ–∞–ª–º—ã—Ä–∑–∞",
                                                                    children: [
                                                                      { 
                                                                        name: "–ñ“±–±–∞–Ω–∞–π",
                                                                        children: [
                                                                          { 
                                                                            name: "–°–∞–¥—ã“õ",
                                                                            children: [
                                                                              { 
                                                                                name: "“ö–∞–∑–∫–µ–π",
                                                                                children: [
                                                                                  { 
                                                                                    name: "–ú–∞—Ä–∞—Ç",
children: [
  { 
    name: "–ë–µ–∫–∞–π–¥–∞—Ä"
  },
  { 
    name: "–ñ–∞–Ω–∞–π–¥–∞—Ä",
    children: [
      { name: "–ê–¥–∏–ª–µ—Ç" }
    ]
  },
  { 
    name: "–î–∞–Ω–∏—è—Ä",
    children: [
      { name: "–ê–ª–º–∞—Å" },
      { name: "–î–∏–∞—Å" }
    ]
  }
]
                                                                                  
                                                                                  },
                                                                                ]
                                                                              }
                                                                            ]
                                                                          }
                                                                        ]
                                                                      }
                                                                    ]
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              { name: "–¢–∞—Ä–∞“õ—Ç—ã" },
              { name: "–°–∞—Ä—ã—Å–æ–ø—ã" },
              { name: "“ö–∞—Ä–∞—Å–æ–ø—ã" },
              { name: "–ê“õ—Å–æ–ª—ã-–ö–µ–Ω–∂–µ—Å–æ–ª—ã" },
              { name: "–¢”ô–Ω–±—ñ—Å–æ–ª—ã" }
            ]
          },
          { name: "–ù–∞–π–º–∞–Ω" },
          { name: "“ö–æ–Ω—ã—Ä–∞—Ç" },
          { name: "“ö—ã–ø—à–∞“õ" },
          { name: "–ö–µ—Ä–µ–π" },
          { name: "–£–∞“õ" }
        ]
      },
      { 
      name: "–ö—ñ—à—ñ –∂“Ø–∑",
      children: [
        { 
          name: "–ë–∞–π“±–ª—ã",
          children: [
            { name: "–ê–¥–∞–π" },
            { name: "–ê–ª–∞—à–∞" },
            { name: "–ñ–∞–ø–ø–∞—Å" },
            { name: "–ë–µ—Ä—ñ—à" },
            { name: "–®–µ—Ä–∫–µ—à" },
            { name: "–ú–∞—Å–∫–∞—Ä" },
            { name: "–¢–∞–∑" },
            { name: "–ï—Å–µ–Ω—Ç–µ–º—ñ—Ä" },
            { name: "“ö—ã–∑—ã–ª“õ“±—Ä—Ç" },
            { name: "–¢”©—Ä—Ç“õ–∞—Ä–∞" },
            { name: "“ö–æ–ª–¥–∞–Ω" }
          ]
        },
        { 
          name: "–ñ–µ—Ç—ñ—Ä—É",
          children: [
            { name: "–¢–∞–±—ã–Ω" },
            { name: "–¢–∞–º–∞" },
            { name: "–ö–µ—Ä–µ–π—ñ—Ç" },
            { name: "–ö–µ—Ä–¥–µ—Ä–∏" },
            { name: "–¢–µ–ª–µ—É" },
            { name: "–†–∞–º–∞–¥–∞–Ω" },
            { name: "“ö–∞—Ä–∞–∫–µ—Å–µ–∫" }
          ]
        },
        { 
          name: "“ö–∞–π—ã—Ä–±–∞–π-“ö–∞—Ä–∞–∫–µ—Å–µ–∫",
          children: [
            { 
              name: "–ë–∞–π—Å–∞—Ä—ã-–∫–µ—Ç–µ",
              children: [
                { 
                  name: "–ë–æ–∑–∞–Ω—à–∞—Ä",
                  children: [
                    { 
                      name: "–ê–¥–∞–º“õ–æ–∂–∞",
                      children: [
                        { 
                          name: "–°”ô–¥—É-–û–∂—ã—Ä–∞–π",
                          children: [
                            { 
                              name: "–ñ”ô–ª—ñ–º–±–µ—Ç",
                              children: [
                                { 
                                  name: "–ë”ô–π—ñ–º–±–µ—Ç",
                                  children: [
                                    { 
                                      name: "–ú”ô–Ω–≥—ñ–±–∞–π",
                                      children: [
                                        { name: "–û–Ω—ã“£“±–ª—ã" }
                                      ]
                                    }
                                  ]
                                },
                                { 
                                  name: "–ú—ã—Ä–∑–∞",
                                  children: [
                                    { 
                                      name: "–†—ã—Å“õ“±–ª",
                                      children: [
                                        { name: "–î”ô—É–ª–µ—Ç—ñ–º–±–µ—Ç" },
                                        { name: "“ö“±–¥–∞–π—Å“Ø–≥—ñ—Ä" },
                                        { name: "“ö–∞–ª—ã–±–µ–∫" },
                                        { name: "“ö–∞—Ä–∞–∫”©–∑" }
                                      ]
                                    },
                                    { 
                                      name: "“ö–∞–π–¥–æ—Å",
                                      children: [
                                        { name: "–ñ–∞–Ω—Ç–æ“õ" }
                                      ]
                                    },
                                    { 
                                      name: "“ö“±—Ç—Ç—ã–º–±–µ—Ç",
                                      children: [
                                        { name: "–û–ª–∂–∞–∫–µ–ª–¥—ñ" },
                                        { name: "–ë–∞–ø–∞–π" },
                                        { name: "–¢”©–ª–µ–≥–µ–Ω—Ç–æ—Ä–ª—ã" }
                                      ]
                                    },
                                    { 
                                      name: "–ñ–∞–Ω–±–∞–π",
                                      children: [
                                        { name: "–ê“õ–∂—ñ–≥—ñ—Ç" },
                                        { name: "–°–∞—Ä–±–∞—Å" },
                                        { name: "–®–æ—Ç“õ–∞—Ä–∞" },
                                        { name: "”®–º—ñ—Ä" },
                                        { name: "–®”ô–ª–¥—ñ–∫" },
                                        { name: "–ú–∞–º–∞" },
                                        { name: "”ò–∂—ñ–±–∞–π" }
                                      ]
                                    },
                                    { 
                                      name: "–ñ–æ–ª–¥—ã–±–∞–π",
                                      children: [
                                        { name: "–¢”ô“£—ñ—Ä–±–µ—Ä–≥–µ–Ω" },
                                        { name: "–¢–æ“£–∞—à–∞" }
                                      ]
                                    },
                                    { name: "”ò–∂—ñ–±–∞–π" }
                                  ]
                                }
                              ]
                            },
                            { 
                              name: "–ñ”ô—Ä—ñ–º–±–µ—Ç",
                              children: [
                                { 
                                  name: "“ö—É—Ä–º–∞–Ω“õ–æ–∂–∞",
                                  children: [
                                    { 
                                      name: "–¢–µ–º—ñ—Ä”ô–ª—ñ",
                                      children: [
                                        { name: "–ï—Å–µ–Ω—Ç–µ–º—ñ—Ä" },
                                        { name: "–ú“±–Ω–∞—Ä–±–∞–π" }
                                      ]
                                    },
                                    { 
                                      name: "“ö–∞–ª“õ–∞–º–∞–Ω",
                                      children: [
                                        { name: "–ê–ª—Ç–∞–π" },
                                        { name: "–ë–æ–∑" },
                                        { name: "–¢–æ“õ—Å–∞–±–∞" },
                                        { name: "–¢–æ–π“ì“±–ª—ã" },
                                        { name: "–ú“Ø–ª–∫–∞–º–∞–Ω" }
                                      ]
                                    },
                                    { 
                                      name: "–°–µ–π—Ç–µ–∫",
                                      children: [
                                        { name: "–°–∞–ª–∞–º–∞—Ç" },
                                        { name: "–ö–µ—à–µ–π" }
                                      ]
                                    },
                                    { name: "–ë–µ–∫–±–∞—É" }
                                  ]
                                },
                                { 
                                  name: "–¢”©–ª–µ–∫",
                                  children: [
                                    { 
                                      name: "–ï—Å–µ–Ω“õ“±–ª",
                                      children: [
                                        { name: "“ö“±—Ç—Ç—ã–±–∞–π" },
                                        { name: "–£–∞–Ω–∞—Å" }
                                      ]
                                    },
                                    { name: "–´—Ä—Å–∞–π" }
                                  ]
                                }
                              ]
                            },
                            { 
                              name: "“ö–æ—Ä—à—ã",
                              children: [
                                { 
                                  name: "–ê–ª–¥–∏—è—Ä",
                                  children: [
                                    { 
                                      name: "–ê—Ä—ã—Å—Ç–∞–±–Ω–∞–π",
                                      children: [
                                        { name: "–ö–µ–Ω–∂–∞–ª—ã" },
                                        { name: "“ö—É–∞–Ω–¥—ã“õ" },
                                        { name: "–ê–π–∂–∞—Ä—ã“õ" }
                                      ]
                                    },
                                    { name: "–ê–π—Ç“õ“±–ª" },
                                    { 
                                      name: "–ê–π—Ç–±–∞–π",
                                      children: [
                                        { name: "–î”ô—Ä—ñ–±–∞–π" },
                                        { name: "–ù–∞—É—à–∞–±–∞–π" },
                                        { name: "–ë”ô—Ä–∫—ñ–º–±–∞–π" },
                                        { name: "–ú“±—Å–∞" }
                                      ]
                                    },
                                    { 
                                      name: "–ú–∞–Ω–∞“õ",
                                      children: [
                                        { name: "–ï—Å—Ç–∏–º–µ—Å" },
                                        { name: "–ñ—É–π–µ—Å–∞—Ä—ã" },
                                        { name: "“ö–∞—Ä–∞–º–µ–Ω" },
                                        { name: "–¢”©–ª–µ–±–∞–π" }
                                      ]
                                    },
                                    { name: "–ë”©–¥–µ—Å" }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { 
              name: "–¢–æ–π“õ–æ–∂–∞-–ê“õ –∫–µ—Ç–µ",
              children: [
                { 
                  name: "–¢“±—Ä—Å—ã–Ω–±–∞–π",
                  children: [
                    { 
                      name: "–ù“±—Ä—Ç–∞–∑–∞",
                      children: [
                        { 
                          name: "–ú“±–Ω–∞–π—Ç–ø–∞—Å",
                          children: [
                            { name: "–ë–∞“ì–∞—É–∏–¥–¥–∏–Ω-–ë–∞—É–ª—ã" },
                            { name: "–ñ–∞–º–∞–ª–µ–¥–¥–µ–Ω-–ñ–∞—É–ª—ã" }
                          ]
                        }
                      ]
                    }
                  ]
                },
                { 
                  name: "“ö–∞—Ä–∞—à",
                  children: [
                    { 
                      name: "–ê–ª—Ç—ã–Ω—à—ã",
                      children: [
                        { 
                          name: "–®“Ø—Ä–µ–≥–µ–π",
                          children: [
                            { name: "–ú–∞–º–∞" },
                            { name: "–¢“Ø–π—Ç–µ" }
                          ]
                        }
                      ]
                    },
                    { name: "–ö”ô—à—ñ–º–±–µ—Ç" }
                  ]
                }
              ]
            },
            { 
              name: "–ú–µ–¥–µ—Ç",
              children: [
                { 
                  name: "“ö—É–∞—Ç",
                  children: [
                    { name: "–ñ–∞–±–∞“ì—ã" },
                    { name: "–ñ–∞–ø–∞“õ" },
                    { name: "–ù–∞—É—Ä—ã–∑" },
                    { name: "–ë–æ—Å—Ç—ã–±–∞–π" }
                  ]
                }
              ]
            },
            { 
              name: "–¢—ñ–ª–µ—Å",
              children: [
                { name: "–°–∞“ì—ã–Ω–¥—ã“õ" }
              ]
            },
            { 
              name: "“Æ–∫—ñ–±–∞–π",
              children: [
                { name: "–ò–≥—ñ–±–∞–π" }
              ]
            },
            { 
              name: "–°”ô–±–¥–µ–Ω-“ö–∞—Ä–∞",
              children: [
                { 
                  name: "“ö–∞–∑—ã",
                  children: [
                    { 
                      name: "–ñ–µ—Ç–µ—Ä–±–∞–π",
                      children: [
                        { 
                          name: "–¢“±–Ω“ì—ã—à–±–∞–π",
                          children: [
                            { name: "–î”ô—É—ñ—Ç" },
                            { name: "–ú–∞—Ö–∞—Ç" },
                            { name: "–î–∞—É—ã–ª" }
                          ]
                        },
                        { 
                          name: "–¢—ñ–ª–µ—É“õ“±–ª",
                          children: [
                            { name: "–ò—Å–∞" },
                            { name: "–®–∞–∫–∏" },
                            { name: "–ú“±—Å–∞" }
                          ]
                        },
                        { name: "–¢—ñ–ª–µ—É–±–∞–π" }
                      ]
                    },
                    { name: "“ö–æ—Å“õ–∞–Ω–∞" }
                  ]
                },
                { 
                  name: "–¢–µ–ª—ñ–±–∞–π",
                  children: [
                    { name: "–®—É–∞“õ" }
                  ]
                },
                { name: "–°–µ–π—Å–µ–Ω–±—ñ" }
              ]
            },
            { name: "–ë”©–ª–µ–∫" },
            { 
              name: "“ö–æ—Ç—ã—Ä",
              children: [
                { 
                  name: "–î–æ—Å“õ–∞–Ω–∞",
                  children: [
                    { name: "–ê—Ä“ì—ã–Ω–±–∞–π" },
                    { name: "“Æ—Å–µ–Ω–±–∞–π" },
                    { name: "”®–∫—Å—ñ–∫–±–∞–π" },
                    { name: "–°–µ–π—Ç–Ω”ô—Å—ñ–º" }
                  ]
                },
                { name: "–¢“±—è“õ" }
              ]
            },
            { 
              name: "–ñ—ã–ª–∫–µ–ª–¥—ñ",
              children: [
                { name: "–ö—ñ–¥—ñ–±–∞–π" },
                { name: "–ñ”©–Ω–µ—Ä–±–∞–π" }
              ]
            },
            { 
              name: "–¢”ô–Ω—ñ—Ä–±–µ—Ä–≥–µ–Ω",
              children: [
                { name: "–ñ–∞—Ä—ã–ª“õ–∞–ø" },
                { name: "–ë–∞—è–Ω" },
                { name: "–ë–µ—Ä–ª—ñ–±–µ–∫" }
              ]
            },
            { name: "–°”ô–º–±–µ—Ç" },
            { name: "“ö–æ—Å—Ç–∞—É" },
            { name: "–ú”ô–º–±–µ—Ç" },
            { 
              name: "–®“Ø—Ä–µ–∫",
              children: [
                { 
                  name: "–ë”©–∫–µ–π",
                  children: [
                    { 
                      name: "–¢–µ“£–µ–ª–±–∞–π",
                      children: [
                        { name: "–¢–µ“£—ñ–∑" }
                      ]
                    },
                    { name: "–¢“±—è“õ" }
                  ]
                },
                { name: "–ñ—ã–ª–∫–µ–ª–¥—ñ" },
                { name: "–¢”ô–Ω—ñ—Ä–±–µ—Ä–≥–µ–Ω" },
                { name: "–°”ô–º–±–µ—Ç" }
              ]
            },
            { 
              name: "–ë–∞—Å–∞—Ä",
              children: [
                { name: "–¢–æ–ª“ì–∞–Ω" },
                { name: "–¢–µ“£—ñ–∑" }
              ]
            },
            { 
              name: "–¢–µ“£–≥–µ–±–∞–π",
              children: [
                { name: "–ë–∞“õ–∞–π" },
                { name: "–¢–æ“õ–∞–π" },
                { name: "–¢”ô–∂–µ–Ω" }
              ]
            },
            { 
              name: "“ö–∞–∑—ã–±–∞–π",
              children: [
                { name: "–ë–æ–ø–∞" },
                { name: "–ö–µ–Ω–∂–µ“õ–∞—Ä–∞" },
                { name: "–®”ô–π" },
                { name: "–î–∞—É—ã–ª–±–∞–π" }
              ]
            },
            { 
              name: "–¢“Ø–º–µ–Ω“õ–æ–∂–∞",
              children: [
                { 
                  name: "–ö–µ—Ç–µ",
                  children: [
                    { 
                      name: "“ö“±—Ä–º–∞–Ω",
                      children: [
                        { 
                          name: "–ë–∞–π–±–æ–ª",
                          children: [
                            { 
                              name: "–ê—Ä“ì—ã–º–±–∞–π",
                              children: [
                                { name: "–°–µ–≥—ñ–∑–µ–∫" }
                              ]
                            },
                            { 
                              name: "–ú“±—Ä–∞—Ç",
                              children: [
                                { name: "–ñ–∏–µ—Å" },
                                { name: "–î–µ—Ä–±—ñ—Å" },
                                { name: "–ñ–∞“õ—Å—ã–ª—ã“õ" },
                                { name: "–ñ–∞“õ–∞—É" }
                              ]
                            },
                            { name: "–ù–∞—Ä—ã–º–±–∞–π" }
                          ]
                        },
                        { name: "–î“Ø–∫–µ—Å" },
                        { name: "–ñ–∞–π—ã–ª“ì–∞–Ω" }
                      ]
                    },
                    { 
                      name: "–°–∞—Å—ã“õ-–°–µ–π—ñ–ª—Ö–∞–Ω",
                      children: [
                        { 
                          name: "–°—ã—Ä—ã–º–±–µ—Ç",
                          children: [
                            { 
                              name: "–û—Ä–∞–∑–∞“õ",
                              children: [
                                { name: "–ï–±–µ—Å–∫—ñ" }
                              ]
                            },
                            { name: "–¢—ñ–ª–µ–ø" }
                          ]
                        },
                        { name: "“ö–∞—Ä“ì–∞–±–∞–π" },
                        { name: "–ú—ã—Å–∞-–°—É–ª–µ–π–º–µ–Ω" },
                        { name: "–ú–µ–π—Ä–∞–º–±–∞–π" },
                        { name: "–ï—Å–µ–Ω–±–∞–π" },
                        { 
                          name: "“ö“±–¥–∞–π“õ“±–ª",
                          children: [
                            { 
                              name: "–ñ—ã–ª–∫–µ–ª–¥—ñ",
                              children: [
                                { name: "–°–∞–ª–∞–º–∞—Ç" },
                                { name: "–°–∞—è—Å–∞—Ç" }
                              ]
                            },
                            { name: "–ò—Ç–±–∞—Å–ø–∞“õ" },
                            { 
                              name: "–®—ã–º–±–æ–ª–∞—Ç",
                              children: [
                                { name: "–ë–æ—Ä–∞—à" },
                                { name: "–ë–µ–∫–±–æ–ª–∞—Ç" }
                              ]
                            },
                            { 
                              name: "–¢–∞–ª–∞—Å–±–∞–π",
                              children: [
                                { name: "–ñ–∞—Ä—ã“õ–±–∞—Å" },
                                { name: "–¢–æ“ì—ã–∑–±–∞–π" },
                                { name: "–¢–æ—Ä“õ–∞–±–∞–π" },
                                { name: "–ë–∞–∑–∞—Ä" },
                                { name: "–ñ–∞–Ω–¥–∞—É–ª–µ—Ç" }
                              ]
                            }
                          ]
                        },
                        { 
                          name: "–¢–µ–º—ñ—Ä",
                          children: [
                            { 
                              name: "–¢–∞–π",
                              children: [
                                { 
                                  name: "–°–∞—Ç—ã–ø–∞–ª–¥—ã",
                                  children: [
                                    { name: "“ö–∞—Ä–∞“ì“±–ª" },
                                    { name: "–ê–π–∂–∞—Ä—ã“õ" },
                                    { name: "–•–∞—Å–∞–Ω" },
                                    { name: "”ò–ª–º“±“õ–∞–Ω" },
                                    { name: "–°–º–∞“ì“±–ª" },
                                    { name: "–´—Å“õ–∞“õ" }
                                  ]
                                },
                                { 
                                  name: "–ï—Å",
                                  children: [
                                    { name: "–Ü–¥—ñ—Ä—ñ—Å" },
                                    { name: "–ï–¥—ñ—Ä—ñ—Å" }
                                  ]
                                }
                              ]
                            },
                            { 
                              name: "–¢“±—Ä“ì–∞–Ω",
                              children: [
                                { name: "–°“±–ª—Ç–∞–Ω“ì–∞–ª–∏" },
                                { 
                                  name: "–°–µ–π—Ç“õ–∞–ª–∏",
                                  children: [
                                    { name: "“ö—É–∞–Ω—ã—à" },
                                    { name: "–®–∞–¥–µ–Ω" }
                                  ]
                                },
                                { name: "“ö“±—Ä–º–∞–Ω“ì–∞–ª–∏" },
                                { name: "–ò–º–∞–Ω“ì–∞–ª–∏" }
                              ]
                            }
                          ]
                        },
                        { 
                          name: "–°–∞—Ä—ã",
                          children: [
                            { 
                              name: "–ê—Å–∞–Ω",
                              children: [
                                { 
                                  name: "–ö–∏—ñ–∫—à—ñ",
                                  children: [
                                    { 
                                      name: "–¢—ñ–ª–µ—É",
                                      children: [
                                        { name: "–û—Ä–∞–∑" },
                                        { name: "–´—Ä—ã—Å–ø–∞–Ω–±–µ—Ç" },
                                        { name: "–ñ–∞–Ω–∞—Ä—ã—Å—Ç–∞–Ω" },
                                        { name: "–°—ã—Ä–ª—ã–±–∞–π" }
                                      ]
                                    },
                                    { 
                                      name: "–®–æ—Ä—Ç—ã“õ",
                                      children: [
                                        { name: "–ê–Ω–¥–∞“õ“±–ª" },
                                        { name: "–î–æ–±–∞–π" },
                                        { name: "“ö–∞—Ä–±–∞" },
                                        { name: "–ë–æ—Å—Ç—ã–±–∞–π" },
                                        { name: "–ö“Ø–ª–∫—ñ" },
                                        { name: "“ö–æ–π–±–∞“õ" },
                                        { name: "–ö–µ–Ω–∂–∞–ª—ã" }
                                      ]
                                    }
                                  ]
                                },
                                { 
                                  name: "“ö–∞—Ä–∞–±–∞–∑–∞—Ä",
                                  children: [
                                    { 
                                      name: "–ö”ô–Ω—ñ—Å–±–µ–∫",
                                      children: [
                                        { name: "–û—Ä–∞–∑-–ë–∞—Ä–¥–∞—É–ª–µ—Ç" },
                                        { name: "–ñ–∏–µ—Å" },
                                        { name: "–ï—Å–µ–Ω–±–µ—Ä–¥—ñ" },
                                        { name: "–ê–π—Ç—É–∞—Ä" },
                                        { name: "“ö–∞–π—ã–ø-“ö–∞–Ω–∞–π" }
                                      ]
                                    },
                                    { 
                                      name: "–ë–µ—Å–µ–Ω",
                                      children: [
                                        { name: "–°”ô–∫–µ–Ω" }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
      { 
        name: "–ñ“Ø–∑–¥–µ–Ω —Ç—ã—Å",
        children: [
          { 
            name: "–¢”©—Ä–µ",
            children: [
              { 
                name: "–®—ã“£“ì—ã—Å —Ö–∞–Ω",
                children: [
                  { 
                    name: "–ñ–æ—à—ã",
                    children: [
                      { 
                        name: "–û—Ä–¥–∞ –ï–∂–µ–Ω",
                        children: [
                          { name: "–°–∞—Ä—Ç–∞“õ—Ç–∞–π –û“ì–ª–∞–Ω" },
                          { name: "–ö—É–ª–∏" },
                          { name: "–ö“Ø—Ä–µ–º—Å–∞" },
                          { name: "–ö“Ø–Ω “õ—ã—Ä–∞–Ω —Ö–∞–Ω" },
                          { name: "–î–∂—É—Ä–º–∞–∫–∞–π" },
                          { name: "–ö—É—Ç—É–∫—É–π" },
                          { name: "–•—É–ª–∞–≥—É –û—Ä–¥–∞" },
                          { name: "–î–∞–∏—Ä-“ö–∞–π–¥–∞–≥“Ø–ª" },
                          { name: "–°–∞—Å—ã –±“±“ì–∞" }
                        ]
                      },
                      { 
                        name: "–ë–∞—Ç—É",
                        children: [
                          { name: "–¢“±“õ–∞–Ω" },
                          { name: "–°–∞—Ä—Ç–∞“õ –•–∞–Ω" },
                          { name: "–î–∞–π—ã—Ä—Ö–∞–Ω" },
                          { name: "–ñ“Ø–Ω—ñ—Å" },
                          { name: "–û–º–∞—Ä" },
                          { name: "“ö–∞–π—ã—Ä–ª—ã" },
                          { name: "–ú–∞–¥–∏—è—Ä" }
                        ]
                      },
                      { 
                        name: "–®–∞–π–±–∞–Ω–∏",
                        children: [
                          { name: "–ë–∞–π–Ω–∞–ª" },
                          { name: "–ë–∞—Ö–∞–¥“Ø—Ä" },
                          { name: "–ö–∞–¥–∞–∫" },
                          { name: "–ë—É–ª–≥–∞–π" }
                        ]
                      },
                      { 
                        name: "–¢–æ“õ–∞–π –¢–µ–º—ñ—Ä",
                        children: [
                          { name: "”®–∑ –¢–µ–º—ñ—Ä" },
                          { name: "“Æ—Ä–¥—ñ-–ú“±—Ö–∞–º–º–µ–¥" },
                          { name: "–°–∞–ª“õ—ã–∂–µ–π" },
                          { name: "–ë–∞–¥—Ä –∞–¥-–î–∏–Ω" }
                        ]
                      },
                      { 
                        name: "–ë–µ—Ä–∫–µ—à–µ—Ä",
                        children: [
                          { name: "–ö—É–∫–¥–∂—É" }
                        ]
                      },
                      { 
                        name: "–ë—É—É–∞–ª",
                        children: [
                          { name: "–ù–æ“ì–∞–π" }
                        ]
                      },
                      { 
                        name: "–°“±“£“õ–∞—Ä",
                        children: [
                          { name: "–¢—É—Ç–∞—Ä" }
                        ]
                      },
                      { 
                        name: "–°–∞“£“ì“±–º",
                        children: [
                          { name: "“ö–∞–ª–µ–∫–µ" }
                        ]
                      },
                      { 
                        name: "–¢“±“õ–∞-–¢–µ–º—ñ—Ä",
                        children: [
                          { name: "–ë–∞–π-–¢–µ–º—ñ—Ä" }
                        ]
                      },
                      { name: "–ë–µ—Ä–∫–µ" }
                    ]
                  },
                  { 
                    name: "–®–∞“ì–∞—Ç–∞–π",
                    children: [
                      { name: "–ú—É—Ç—É–≥—ç–Ω" },
                      { name: "–ï—Å—É-–ú—É–Ω–∫—ç" },
                      { name: "–ë–∞–π–¥–∞—Ä" },
                      { name: "–°–∞—Ä—É–±–∞–Ω" },
                      { name: "–ú—É–∂–∏ –Ø—è" }
                    ]
                  },
                  { 
                    name: "“Æ–≥–µ–¥–µ–π",
                    children: [
                      { 
                        name: "–ì“Ø–π—ñ–∫",
                        children: [
                          { name: "–•–æ–∂–∞ –û“ì“±–ª" },
                          { name: "–ù–∞“ì—É" },
                          { name: "–•—É“õ—É" }
                        ]
                      },
                      { name: "“ö–æ–¥–∞–Ω" },
                      { 
                        name: "–ö“Ø—à—É",
                        children: [
                          { name: "“ö–∞–π–¥—É" }
                        ]
                      },
                      { name: "“ö–∞—à—ã" },
                      { name: "“ö–∞–¥–∞–Ω" }
                    ]
                  },
                  { 
                    name: "–¢”©–ª–µ",
                    children: [
                      { 
                        name: "–ú”©“£–∫–µ",
                        children: [
                          { name: "–ê—Å—É–¥–∞–π" },
                          { name: "–®–∏—Ä–µ–º“Ø–Ω" },
                          { name: "–®–∏—Ä–µ–Ω" }
                        ]
                      },
                      { 
                        name: "“ö“±–±—ã–ª–∞–π",
                        children: [
                          { 
                            name: "–ß–∏–Ω–∫–∏–º",
                            children: [
                              { name: "–¢—ç–º—É—Ä" },
                              { name: "–î–∞—Ä–∞–º–±–∞–ª–∞" },
                              { name: "–ì–∞–º–º–∞–ª–∞" }
                            ]
                          },
                          { name: "–î–∞—Ä–º–∞–±–∞–ª–∞" },
                          { name: "–¢–µ–º“Ø—Ä" }
                        ]
                      },
                      { 
                        name: "–ê—Ä—ã“õ-–ë“±“ì–∞",
                        children: [
                          { name: "–ò–µ—à—É–º—É–Ω–∫–µ" },
                          { name: "–ù–æ–º“±“õ–∞" },
                          { name: "–ú“±“õ–∞–ª–∏" }
                        ]
                      },
                      { 
                        name: "–•—É–ª–∞“ì—É",
                        children: [
                          { 
                            name: "–ê–±–∞“ì–∞",
                            children: [
                              { name: "–ê—Ä“ì“±–Ω —Ö–∞–Ω" },
                              { name: "“í–∞–π—Ö–∞—Ç—ã" }
                            ]
                          },
                          { name: "–ê—Ö–º–µ–¥-–¢—ç–∫—É–¥—ç—Ä" },
                          { name: "–Æ—à–º—É—Ç—å" },
                          { name: "“í–∞–∑–∞–Ω" },
                          { name: "–û–ª–∂–∞–π—Ç—É" },
                          { name: "”ò–±—É –°–∞–π–¥" }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          { 
            name: "–¢”©–ª–µ“£–≥—ñ—Ç",
            children: [
              { 
                name: "–ñ–∞“£–∞–∑—ã—Ä",
                children: [
                  { name: "–°–∞—Ä—ã—Ç–∞–±—ã–Ω" },
                  { name: "“ö–∞–Ω–∞–π" },
                  { name: "“ö–æ–Ω–∞–π" },
                  { name: "–¢–∞“õ–∞–π" },
                  { name: "–ê—é-—Å–∞—Ä—ã" },
                  { name: "–£–∞–Ω–∞—Å" },
                  { name: "–ñ”©–ª–∫–µ" },
                  { name: "–ñ–∞–Ω–∞–π –¢–∞–∑" },
                  { name: "–ë–æ—Ä–∞–Ω" },
                  { name: "–°–∞–±—ã–Ω—à—ã" }
                ]
              },
              { 
                name: "“ö—ã—Ä“ì—ã–∑",
                children: [
                  { 
                    name: "“ö“±—Å—à—ã",
                    children: [
                      { name: "–ñ–æ–±–∞" },
                      { name: "“ö–∞—Ä—ã–º—Å–∞“õ" },
                      { name: "–ú–µ–Ω–¥—ñ–±–∞–π" },
                      { name: "–¢–∞–∑ “ö“±—Å—à—ã" }
                    ]
                  }
                ]
              },
              { 
                name: "–ú–∞–º–∞–¥–∞–π—ã—Ä",
                children: [
                  { 
                    name: "”®–º—ñ—Ä–∑–∞“õ",
                    children: [
                      { name: "–°–∞–±–∞–Ω—à—ã" },
                      { name: "–ù–∞–π–º–∞–Ω-–¢”©–ª–µ–Ω–≥—ñ—Ç" },
                      { name: "–°–∞—Ä—ã" }
                    ]
                  }
                ]
              },
              { 
                name: "–°–∞—Ä—ã—Ç“±–º–∞“õ",
                children: [
                  { 
                    name: "–ê–∂—ã—Ö–∞–Ω",
                    children: [
                      { name: "–°–∞“ì—ã–Ω–¥—ã“õ" }
                    ]
                  },
                  { name: "–î“±—Å–∞“õ–∞–π" },
                  { name: "–ê–π—Ç“õ“±–ª" }
                ]
              },
              { 
                name: "–ö”©–∫–∫”©–∑",
                children: [
                  { name: "–ñ“±–º–∞“õ–∞–π" },
                  { name: "“ö“±–¥–∞–π–±–µ—Ä–≥–µ–Ω" },
                  { name: "”®—Ç–µ–≥–µ–Ω" },
                  { name: "–ñ–∏–µ–Ω“õ“±–ª" }
                ]
              },
              { 
                name: "–ú–∞–º—ã—Ç-–∂–µ–ª–¥–µ–Ω",
                children: [
                  { name: "–ö“Ø–Ω—Ç—É" },
                  { name: "–ê–π—Ç—É" }
                ]
              },
              { 
                name: "“ö–∞–ª–º–∞“õ",
                children: [
                  { name: "–ê–ª—Ç–∞–π" },
                  { name: "–ú–∞“£–¥–∞–π" },
                  { name: "“ö“±—Ä—ã–º" },
                  { name: "–°–∞—Å—ã–π—ã–Ω" },
                  { name: "–ú–µ—Ä–≥–µ–Ω" },
                  { name: "–ñ–∞—Å—ã–±–∞–π" },
                  { name: "–ë–µ–ª–≥—ñ—Å—ñ–∑ –∞—Ç–∞–ª–∞—Ä" }
                ]
              },
              { 
                name: "–ú–µ—Ä–≥–µ–Ω",
                children: [
                  { name: "–®–∞–π—Ö—ã—Å—ã“õ" }
                ]
              },
              { 
                name: "–ë”©–∫–µ–π–ª—ñ–∫—Ç–µ—Ä",
                children: [
                  { name: "–°–µ–π–¥”ô–ª—ñ" },
                  { name: "–ú”ô–∫—ñ" }
                ]
              },
              { 
                name: "“∞—è–ª—ã —Ç”©–ª–µ“£–≥—ñ—Ç—Ç–µ—Ä—ñ",
                children: [
                  { 
                    name: "–ë–∞—Ç—ã—Ä –¢”©–∫–µ–Ω",
                    children: [
                      { name: "“ö–æ—Å“õ“±–ª–∞“õ" }
                    ]
                  }
                ]
              },
              { name: "“ö–æ–∂–∞–Ω-–ë–µ—Ä–ª—ñ" },
              { name: "–ñ—ñ–±–µ–∫" },
              { name: "–°–∞—Ä—ã“ì“±—Ä—Ç“õ–∞" },
              { name: "–°–∞—Ä—É" },
              { name: "“ö–æ–ø–µ–∫—ñ" },
              { name: "“ö—ã–ø—à–∞“õ-“ö—ã—Ä“ì—ã–∑" },
              { name: "”ò–Ω–µ–ª" },
              { name: "–®—ã—Ä–¥–∞–π" },
              { name: "–ê–ª–∞–∫”©—à–µ–∫" },
              { name: "–ê–π–¥–∞—Ä–±–µ–∫" },
              { name: "–°–∞—è“õ" },
              { name: "–ñ“Ø–Ω–¥—ñ" },
              { name: "–î–µ–π—Ç" },
              { 
                name: "–†–∞“õ—ã–º",
                children: [
                  { name: "–®–æ–Ω–∏" },
                  { name: "–†–∞–º–∞–∑–∞–Ω" },
                  { name: "“ö—ã–∑–¥–∞—Ä–±–µ–∫-–°–∞—Ä–∞" }
                ]
              },
              { 
                name: "–®–µ—Ä—ñ–∫",
                children: [
                  { 
                    name: "“ö–æ–∂–∞–Ω",
                    children: [
                      { name: "–ö–µ–Ω–∂–µ–±–æ–ª–∞—Ç" }
                    ]
                  }
                ]
              }
            ]
          },
          { 
            name: "“ö–æ–∂–∞",
            children: [
              { name: "–ù–∞–∑–∞—Ä “ö–æ–∂–∞" },
              { name: "–ê–ª–∏ –∏–±–Ω –ê–±—É –¢–æ–ª–∏–±" },
              { name: "–ú”ô—Ç–µ–Ω “ö–æ–∂–∞" },
              { name: "–ê–±–¥—É–ª–ª–∞—Ö “ö–æ–∂–∞" },
              { name: "“ö–∞–∂—ã –ú”ô–¥—ñ-–î—É–∞–Ω–∞ “ö–æ–∂–∞" },
              { name: "–®–∞–ª–º–∞–ª—ã “ö–æ–∂–∞" },
              { name: "–°–∞–±—ã–ª—Ç “ö–æ–∂–∞" },
              { name: "–ê–±–¥—É–ª–º–∞–Ω–∞–ø" },
              { name: "–ñ–∞–ª–∞–Ω–∞—è“õ “ö–æ–∂–∞" },
              { name: "“ö–æ—Å—ã–º “ö–æ–∂–∞" },
              { name: "–ê“õ“õ–æ—Ä“ì–∞–Ω–¥—ã“õ “ö–æ–∂–∞" },
              { name: "”ò–∑–µ—Ä “ö–æ–∂–∞" },
              { name: "–®–∞—Ö –±“Ø–∑—ñ—Ä—ñ–∫" },
              { name: "–ñ–∞–ª–ø–∞“õ" },
              { name: "–ö–µ—Ç—Ç—ñ “ö–æ–∂–∞" },
              { name: "–ë–∞“õ—Å–∞–π—ã—Å “õ–æ–∂–∞" },
              { name: "–ë–µ–∫–º—ã—Å—ã“õ" },
              { name: "“ö–æ–∂–∞–º“õ“±–ª" },
              { name: "–®–∞–π—Ö–∞–Ω—Ç–∞—É—ã—Ä" },
              { name: "–ê–±–¥—É–º–∞–Ω–∞–ø" },
              { name: "–ê“õ“õ–æ—Ä“ì–∞–Ω–¥—ã“õ “ö–æ–∂–∞" },
              { name: "–ö–∞—Ä–∞—Ö–∞–Ω “ö–æ–∂–∞" },
              { name: "“ö—ã–ª—ã—à “ö–æ–∂–∞" },
              { name: "–ú–∞“ì–∑–∞–º–∞–Ω “ö–æ–∂–∞" }
            ]
          },
          { 
            name: "–°“±–Ω–∞“õ",
            children: [
              { 
                name: "“ö–∞–π“ì–∞“õ—Ç—ã“õ",
                children: [
                  { name: "“ö–∞—Ç–∞“ì–∞–Ω ”ò–∑–∏–∑" },
                  { name: "–ö–∞–ª–º–∞h–∞–º–º–µ—Ç" }
                ]
              },
              { name: "–ë–µ—Å—Å–∞—Ä—ã" },
              { name: "–ê—Ç–∞—à" },
              { name: "“ö–∞–ª–º—ã—Ä–∑–∞-–¢–æ“õ–ø–∞–Ω" },
              { name: "–°–∏—ã“õ" }
            ]
          },
          { 
            name: "“ö—ã—Ä“ì—ã–∑",
            children: [
              { 
                name: "–ë–∞—Ä–∞“õ",
                children: [
                  { name: "–ê“õ–∫—ñ—Å—ñ" },
                  { name: "–†—ã—Å“õ“±–ª" },
                  { name: "–ë–µ–π—ñ–º–±–µ—Ç" },
                  { name: "–ë–∞–π“õ–∞–±—ã–ª" }
                ]
              },
              { 
                name: "–¢–∞—Ç–∞",
                children: [
                  { name: "–°–∞“ì—ã–Ω–¥—ã“õ" },
                  { name: "“ö–∞–ª–º–∞—Ç–∞–π" },
                  { name: "“ö–æ—è–Ω–∞“õ" },
                  { name: "–ï—Å—Ç–µ–º—ñ—Å" }
                ]
              },
              { 
                name: "“ö“±—Å—à—ã",
                children: [
                  { name: "–ï—Å—Ç–µ–∫—ñ-“ö–∞“ì–∞–∑–¥—ã" },
                  { name: "“ö—ã–Ω–∞" },
                  { name: "–ö”©—à–µ–∫" },
                  { name: "–ù“±—Ä—Ç–∞–π" },
                  { name: "–û—Ä—Ç–∞—É" },
                  { name: "–°–∞—Ä—ã" },
                  { name: "“ö“±–¥–∞–π–º–µ–Ω–¥—ñ" }
                ]
              }
            ]
          },
          { 
            name: "–ù–æ“ì–∞–π-“ö–∞–∑–∞“õ",
            children: [
              { name: "“Æ–π—Å—ñ–Ω-–ù–æ“ì–∞–π" },
              { name: "“ö–æ—è—Å “ö“±—è—Å" },
              { name: "“ö–∞–∑–∞–Ω“ö“±–ª–∞“õ" },
              { name: "“ö–æ—Å—Ç–∞“£–±–∞–ª—ã" },
              { name: "“ö–∞–±–∞“õ-–ù–æ“ì–∞–π" }
            ]
          },
          { 
            name: "–ú–∞“£“ì—ã—Ç",
            children: [
              { 
                name: "–ï–¥—ñ–≥–µ",
                children: [
                  { 
                    name: "–ú–∞–Ω—Å“±—Ä",
                    children: [
                      { 
                        name: "–ú“±—Å–∞",
                        children: [
                          { name: "–°–∏—Ä–∞“õ" }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          { 
            name: "–ö”©–ª–µ–≥–µ–Ω",
            children: [
              { 
                name: "–ö–µ–Ω–∂–µ–±–∞–π",
                children: [
                  { name: "–•–∞–Ω–∫–µ–ª–¥—ñ" },
                  { name: "–ú–∞–º–∞—Ç" },
                  { name: "–ê“õ“õ–∞—Ä–∞" },
                  { name: "”ò–ª–º”ô–º–±–µ—Ç" }
                ]
              }
            ]
          },
          { 
            name: "–ö–µ–Ω–µ–≥–µ—Å",
            children: [
              { 
                name: "–¢“Ø–ª–∫—ñ—Ç“±“ì–∞—Ä",
                children: [
                  { name: "–ê“õ“±—è–ª–∞—Å" }
                ]
              }
            ]
          },
          { 
            name: "“ö–∏—è—Ç",
            children: [
              { name: "“ö–∞—Ä–∞—É—ã–ª" },
              { name: "–¢–∞—É—à—ã“õ" },
              { name: "–ù”ô–¥—ñ—Ä" },
              { name: "–ë–µ—Ä–∂—ñ–≥—ñ—Ç" }
            ]
          },
          { 
            name: "–î—Ä—É–≥–∏–µ —Ä–æ–¥—ã",
            children: [
              { name: "”®—à—ñ—Ä–µ—Ç—ñ–Ω" },
              { name: "–ê“õ“õ–æ–∑—ã" },
              { name: "–ê“õ–∂–æ–ª" },
              { name: "“ö–æ–∂–∞–≥–µ–ª–¥—ñ" },
              { name: "–ú“±—Å–∞" },
              { name: "–°–∞“ì—ã–Ω–±–µ–∫" },
              { name: "–î–∞–Ω–∏—è—Ä" }
            ]
          }
        ]
      }
    ]
  };

  // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø LOCALSTORAGE
  function initStorage() {
    if (!localStorage.getItem(STORAGE_KEYS.TREE)) {
      localStorage.setItem(STORAGE_KEYS.TREE, JSON.stringify(currentTreeData));
    } else {
      currentTreeData = JSON.parse(localStorage.getItem(STORAGE_KEYS.TREE));
    }
    
    if (!localStorage.getItem(STORAGE_KEYS.REQUESTS)) {
      localStorage.setItem(STORAGE_KEYS.REQUESTS, JSON.stringify([]));
    }
    
    if (!localStorage.getItem(STORAGE_KEYS.APPROVED)) {
      localStorage.setItem(STORAGE_KEYS.APPROVED, JSON.stringify([]));
    }
    
    if (!localStorage.getItem(STORAGE_KEYS.PASSWORD)) {
      localStorage.setItem(STORAGE_KEYS.PASSWORD, ADMIN_PASSWORD);
    }
  }

  // –ü–û–õ–£–ß–ï–ù–ò–ï –î–ê–ù–ù–´–• –ò–ó LOCALSTORAGE
  function getRequests() {
    return JSON.parse(localStorage.getItem(STORAGE_KEYS.REQUESTS) || '[]');
  }

  function getApproved() {
    return JSON.parse(localStorage.getItem(STORAGE_KEYS.APPROVED) || '[]');
  }

  // –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• –í LOCALSTORAGE
  function saveRequests(requests) {
    localStorage.setItem(STORAGE_KEYS.REQUESTS, JSON.stringify(requests));
  }

  function saveApproved(approved) {
    localStorage.setItem(STORAGE_KEYS.APPROVED, JSON.stringify(approved));
  }

  function saveTree() {
    localStorage.setItem(STORAGE_KEYS.TREE, JSON.stringify(currentTreeData));
  }

  // –î–û–ë–ê–í–õ–ï–ù–ò–ï –ó–ê–Ø–í–ö–ò
  function addRequest(request) {
    const requests = getRequests();
    request.id = Date.now();
    request.date = new Date().toLocaleString();
    request.status = 'pending';
    requests.push(request);
    saveRequests(requests);
    return request;
  }

  // –û–î–û–ë–†–ï–ù–ò–ï –ó–ê–Ø–í–ö–ò
  function approveRequest(requestId) {
    const requests = getRequests();
    const approved = getApproved();
    
    const requestIndex = requests.findIndex(r => r.id === requestId);
    if (requestIndex !== -1) {
      const request = requests[requestIndex];
      request.status = 'approved';
      
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –¥–µ—Ä–µ–≤–æ
      addPersonToTree(request.name, request.parent, request.info);
      
      approved.push(request);
      requests.splice(requestIndex, 1);
      
      saveRequests(requests);
      saveApproved(approved);
      saveTree();
      
      return true;
    }
    return false;
  }

  // –û–¢–ö–õ–û–ù–ï–ù–ò–ï –ó–ê–Ø–í–ö–ò
  function rejectRequest(requestId) {
    const requests = getRequests();
    const requestIndex = requests.findIndex(r => r.id === requestId);
    
    if (requestIndex !== -1) {
      requests[requestIndex].status = 'rejected';
      saveRequests(requests);
      return true;
    }
    return false;
  }

  // –î–û–ë–ê–í–õ–ï–ù–ò–ï –ß–ï–õ–û–í–ï–ö–ê –í –î–ï–†–ï–í–û
  function addPersonToTree(name, parentName, info) {
    function findNode(node, targetName) {
      if (node.name === targetName) return node;
      if (node.children) {
        for (let child of node.children) {
          const found = findNode(child, targetName);
          if (found) return found;
        }
      }
      if (node._children) {
        for (let child of node._children) {
          const found = findNode(child, targetName);
          if (found) return found;
        }
      }
      return null;
    }
    
    const parentNode = findNode(currentTreeData, parentName);
    if (parentNode) {
      if (!parentNode.children) parentNode.children = [];
      parentNode.children.push({
        name: name,
        info: info,
        dateAdded: new Date().toISOString()
      });
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ä–µ–≤–æ
      if (document.getElementById('people-section').classList.contains('active')) {
        initTree();
      }
      
      return true;
    }
    return false;
  }

  // ========== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –Ø–ó–´–ö–ê ==========
  const langButtons = document.querySelectorAll('.lang-btn');
  
  langButtons.forEach(btn => {
    btn.addEventListener('click', function() {
      const lang = this.getAttribute('data-lang');
      
      if (lang === currentLanguage) return;
      
      // –£–±–∏—Ä–∞–µ–º active —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      langButtons.forEach(b => b.classList.remove('active'));
      // –î–æ–±–∞–≤–ª—è–µ–º active —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
      this.classList.add('active');
      
      // –ú–µ–Ω—è–µ–º —è–∑—ã–∫
      currentLanguage = lang;
      document.documentElement.lang = lang;
      translatePage();
    });
  });

  // –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–í–û–î–ê –°–¢–†–ê–ù–ò–¶–´
  function translatePage() {
    const t = translations[currentLanguage];
    
    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.title = t.title;
    
    // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∫–æ–Ω–æ–∫ –≤ header
    document.querySelector('[data-section="people"]').title = t.header.people;
    document.querySelector('[data-section="search"]').title = t.header.search;
    document.querySelector('[data-section="add"]').title = t.header.add;
    document.querySelector('[data-section="requests"]').title = t.header.requests;
    document.querySelector('[data-section="help"]').title = t.header.help;
    document.querySelector('[data-section="stats"]').title = t.header.stats;
    
    // –ü–ª–∞–≤–∞—é—â–∏–µ –∫–Ω–æ–ø–∫–∏
    document.querySelector('.floating-btn').title = t.tree.addNode;
    document.querySelector('.admin-btn').title = t.tree.requests;
    
    // –ü–æ–∏—Å–∫
    document.querySelector('.search-box').placeholder = t.search.placeholder;
    document.querySelector('#search-section h3').textContent = t.search.results;
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ
    document.querySelector('#add-section h2').textContent = t.add.title;
    document.querySelector('#add-section p').innerHTML = `<i class="fas fa-info-circle"></i> ${t.add.info}`;
    document.querySelector('label[for="person-name"]').textContent = t.add.name;
    document.querySelector('#person-name').placeholder = t.add.namePlaceholder;
    document.querySelector('label[for="parent-select"]').textContent = t.add.parent;
    document.querySelector('#parent-select option').textContent = t.add.selectParent;
    document.querySelector('label[for="person-info"]').textContent = t.add.infoLabel;
    document.querySelector('#person-info').placeholder = t.add.infoPlaceholder;
    document.querySelector('label[for="person-email"]').textContent = t.add.email;
    document.querySelector('#person-email').placeholder = t.add.emailPlaceholder;
    document.querySelector('#submit-request-btn').textContent = t.add.button;
    
    // –ó–∞—è–≤–∫–∏
    document.querySelector('#requests-section h2').textContent = t.requests.title;
    document.querySelector('#admin-instructions').innerHTML = `<i class="fas fa-lock"></i> ${t.requests.adminOnly}`;
    
    // –ü–æ–º–æ—â—å
    document.querySelector('#help-section h2').textContent = t.help.title;
    
    const helpItems = document.querySelectorAll('.help-item');
    helpItems[0].querySelector('h3').textContent = t.help.treeTitle;
    const treePoints = helpItems[0].querySelectorAll('p');
    t.help.treePoints.forEach((point, index) => {
      if (treePoints[index]) {
        treePoints[index].innerHTML = '‚Ä¢ ' + point;
      }
    });
    
    helpItems[1].querySelector('h3').textContent = t.help.searchTitle;
    const searchPoints = helpItems[1].querySelectorAll('p');
    t.help.searchPoints.forEach((point, index) => {
      if (searchPoints[index]) {
        searchPoints[index].innerHTML = '‚Ä¢ ' + point;
      }
    });
    
    helpItems[2].querySelector('h3').textContent = t.help.addTitle;
    const addPoints = helpItems[2].querySelectorAll('p');
    t.help.addPoints.forEach((point, index) => {
      if (addPoints[index]) {
        addPoints[index].innerHTML = '‚Ä¢ ' + point;
      }
    });
    
    helpItems[3].querySelector('h3').textContent = t.help.requestsTitle;
    const requestsPoints = helpItems[3].querySelectorAll('p');
    t.help.requestsPoints.forEach((point, index) => {
      if (requestsPoints[index]) {
        requestsPoints[index].innerHTML = '‚Ä¢ ' + point;
      }
    });
    
    helpItems[4].querySelector('h3').textContent = t.help.statsTitle;
    const statsPoints = helpItems[4].querySelectorAll('p');
    t.help.statsPoints.forEach((point, index) => {
      if (statsPoints[index]) {
        statsPoints[index].innerHTML = '‚Ä¢ ' + point;
      }
    });
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    const statCards = document.querySelectorAll('.stat-card');
    statCards[0].querySelector('h3').textContent = t.stats.totalPeople;
    statCards[0].querySelector('.stat-label').textContent = t.stats.totalPeopleLabel;
    
    statCards[1].querySelector('h3').textContent = t.stats.levels;
    statCards[1].querySelector('.stat-label').textContent = t.stats.levelsLabel;
    
    statCards[2].querySelector('h3').textContent = t.stats.branches;
    statCards[2].querySelector('.stat-label').textContent = t.stats.branchesLabel;
    
    statCards[3].querySelector('h3').textContent = t.stats.leaves;
    statCards[3].querySelector('.stat-label').textContent = t.stats.leavesLabel;
    
    statCards[4].querySelector('h3').textContent = t.stats.requests;
    statCards[4].querySelector('.stat-label').textContent = t.stats.requestsLabel;
    
    statCards[5].querySelector('h3').textContent = t.stats.approved;
    statCards[5].querySelector('.stat-label').textContent = t.stats.approvedLabel;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ä–µ–≤–æ, –µ—Å–ª–∏ –æ–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ
    if (document.getElementById('people-section').classList.contains('active')) {
      setTimeout(initTree, 100);
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫
    if (document.getElementById('requests-section').classList.contains('active')) {
      loadRequests();
    }
  }

  // ========== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –°–ï–ö–¶–ò–ô ==========
  const sections = document.querySelectorAll('.section');
  const icons = document.querySelectorAll('header .icon');
  
  icons.forEach(icon => {
    icon.addEventListener('click', function() {
      const sectionId = this.getAttribute('data-section');
      
      // –£–±–∏—Ä–∞–µ–º active —É –≤—Å–µ—Ö –∏–∫–æ–Ω–æ–∫
      icons.forEach(i => i.classList.remove('active'));
      // –î–æ–±–∞–≤–ª—è–µ–º active —Ç–µ–∫—É—â–µ–π –∏–∫–æ–Ω–∫–µ
      this.classList.add('active');
      
      // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
      sections.forEach(section => section.classList.remove('active'));
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å–µ–∫—Ü–∏—é
      document.getElementById(`${sectionId}-section`).classList.add('active');
      
      // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –¥–µ—Ä–µ–≤–æ - –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
      if (sectionId === 'people') {
        setTimeout(initTree, 100);
      }
      
      // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É - –æ–±–Ω–æ–≤–ª—è–µ–º –µ—ë
      if (sectionId === 'stats') {
        updateStatistics();
      }
      
      // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ - –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ä–æ–¥–∏—Ç–µ–ª–µ–π
      if (sectionId === 'add') {
        updateParentSelect();
      }
      
      // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∑–∞—è–≤–∫–∏ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å
      if (sectionId === 'requests') {
        checkAdminAccess();
      }
    });
  });

  // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –î–ï–†–ï–í–ê ==========
  function initTree() {
    const width = window.innerWidth;
    const height = window.innerHeight - 55;

    d3.select("#tree-container").html("");

    svg = d3.select("#tree-container")
      .append("svg")
      .attr("width", width)
      .attr("height", height);

    g = svg.append("g")
      .attr("transform", `translate(${width / 2 - 80}, ${height / 2})`);

    // ZOOM —Ñ—É–Ω–∫—Ü–∏—è
    zoom = d3.zoom()
      .scaleExtent([0.1, 3])
      .on("zoom", (event) => {
        g.attr("transform", event.transform);
      });
    
    svg.call(zoom)
      .on("dblclick.zoom", null);

    // –£–º–µ–Ω—å—à–∞–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ –¥–ª—è –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    const treeLayout = d3.tree()
      .nodeSize([60, 240]);

    treeRoot = d3.hierarchy(currentTreeData);

    // –°–í–û–†–ê–ß–ò–í–ê–ï–ú –í–°–ï –£–ó–õ–´ –ö–†–û–ú–ï –ê–õ–ê–®
    function collapseAllExceptRoot(d) {
      if (d.depth > 0 && d.children) {
        d._children = d.children;
        d._children.forEach(collapseAllExceptRoot);
        d.children = null;
      }
    }
    
    if (treeRoot.children) {
      treeRoot.children.forEach(collapseAllExceptRoot);
    }

    treeRoot.x0 = 0;
    treeRoot.y0 = 0;

    updateTree(treeRoot);

    function updateTree(source) {
      const duration = 400;
      treeLayout(treeRoot);

      const nodes = treeRoot.descendants();
      const links = treeRoot.links();

      const node = g.selectAll("g.node-group")
        .data(nodes, d => d.id || (d.id = ++i));

      /* ===== EXIT ===== */
      node.exit()
        .transition().duration(duration)
        .attr("transform", d => `translate(${source.y},${source.x})`)
        .style("opacity", 0)
        .remove();

      /* ===== ENTER ===== */
      const nodeEnter = node.enter()
        .append("g")
        .attr("class", "node-group")
        .attr("transform", `translate(${source.y0},${source.x0})`)
        .style("opacity", 0)
        .on("click", (e, d) => {
          e.stopPropagation();
          
          // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É–∑–ª–∞
          if (selectedNode) {
            d3.select(selectedNode).select(".node-card").classed("selected", false);
          }
          
          // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª
          const currentNode = d3.select(e.currentTarget);
          currentNode.select(".node-card").classed("selected", true);
          selectedNode = e.currentTarget;
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —É–∑–ª–µ
          showNodeInfo(d);
          
          // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º/—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
          if (d.children) {
            d._children = d.children;
            d.children = null;
          } else {
            d.children = d._children;
            d._children = null;
          }
          updateTree(d);
        });

      // –ö–ê–†–¢–û–ß–ö–ê –£–ó–õ–ê - –û–í–ê–õ–¨–ù–ê–Ø (–ú–ï–ù–¨–®–ï) –° –ö–†–£–ñ–ö–û–ú –£ –õ–ï–í–û–ì–û –ö–†–ê–Ø
      nodeEnter.append("rect")
        .attr("class", d => {
          let cardClass = "node-card";
          if (d._children) cardClass += " collapsed";
          if (d.children) cardClass += " expanded";
          return cardClass;
        })
        .attr("x", 0)
        .attr("y", -25)
        .attr("width", 150)
        .attr("height", 50)
        .attr("rx", 25)
        .attr("ry", 25);

      // –ö–†–£–ì –î–õ–Ø –§–û–¢–û–ì–†–ê–§–ò–ò - –ü–†–Ø–ú–û –£ –õ–ï–í–û–ì–û –ö–†–ê–Ø –ö–ê–†–¢–û–ß–ö–ò
      nodeEnter.append("clipPath")
        .attr("id", d => `clip-${d.id}`)
        .append("circle")
        .attr("cx", 25)
        .attr("cy", 0)
        .attr("r", 20);

      // –§–û–¢–û–ì–†–ê–§–ò–Ø - –ü–†–Ø–ú–û –£ –õ–ï–í–û–ì–û –ö–†–ê–Ø
nodeEnter.append("image")
  .attr("x", 5)
  .attr("y", -20)
  .attr("width", 40)
  .attr("height", 40)
  .attr("href", d => {
    // –î–ª—è —É–∑–ª–∞ –ê—Ä“ì—ã–Ω –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ç–æ argyn.jpeg
    if (d.data.name === "–ê—Ä“ì—ã–Ω") {
      return "images/argyn.jpeg";
    }
    // –î–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —é—Ä—Ç—ã
    return "images/yurt.png";
  })
  .attr("clip-path", d => `url(#clip-${d.id})`)
  .attr("preserveAspectRatio", "xMidYMid slice");

      // –¢–ï–ö–°–¢ - –°–î–í–ò–ì–ê–ï–ú –í–ü–†–ê–í–û –û–¢ –ö–†–£–ñ–ö–ê
      nodeEnter.append("text")
        .attr("class", "node-text")
        .attr("x", 55)
        .attr("y", 0)
        .style("font-size", "11px")
        .text(d => {
          const name = d.data.name;
          if (name.length > 12) return name.substring(0, 11) + "...";
          return name;
        });

      /* ===== UPDATE ===== */
      const nodeUpdate = nodeEnter.merge(node);

      nodeUpdate.transition()
        .duration(duration)
        .attr("transform", d => `translate(${d.y},${d.x})`)
        .style("opacity", 1);

      // –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∫–∞—Ä—Ç–æ—á–∫–∏
      nodeUpdate.select("rect")
        .attr("class", d => {
          let cardClass = "node-card";
          if (d._children) cardClass += " collapsed";
          if (d.children) cardClass += " expanded";
          return cardClass;
        });

      // –ü–æ–¥–≥–æ–Ω—è–µ–º —à–∏—Ä–∏–Ω—É –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–¥ —Ç–µ–∫—Å—Ç
      nodeUpdate.select("rect")
        .transition()
        .duration(duration)
        .attr("width", function() {
          const text = this.parentNode.querySelector("text");
          const textWidth = text ? text.getBBox().width : 0;
          return Math.max(150, textWidth + 70);
        });

      /* ===== LINKS ===== */
      const link = g.selectAll("path.link")
        .data(links, d => d.target.id);

      link.exit()
        .transition().duration(duration)
        .style("opacity", 0)
        .remove();

      link.enter()
        .append("path")
        .attr("class", "link")
        .merge(link)
        .transition()
        .duration(duration)
        .attr("d", d => {
          const sourceNode = d.source;
          const targetNode = d.target;
          const sourceRect = sourceNode.nodeRectWidth || 150;
          const targetRect = targetNode.nodeRectWidth || 150;
          
          const startX = sourceNode.y + sourceRect;
          const endX = targetNode.y;
          const startY = sourceNode.x;
          const endY = targetNode.x;
          
          const controlX1 = startX + (endX - startX) * 0.5;
          const controlX2 = startX + (endX - startX) * 0.5;
          
          return `
            M ${startX} ${startY}
            C ${controlX1} ${startY},
              ${controlX2} ${endY},
              ${endX} ${endY}
          `;
        })
        .style("opacity", 1);

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —à–∏—Ä–∏–Ω—É –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è —É–∑–ª–∞
      nodes.forEach(d => {
        d.x0 = d.x;
        d.y0 = d.y;
        const nodeElement = d3.select(d3.selectAll(".node-group").nodes()[nodes.indexOf(d)]);
        if (nodeElement.size() > 0) {
          const rect = nodeElement.select("rect").node();
          if (rect) {
            d.nodeRectWidth = rect.getBBox().width;
          }
        }
      });
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —É–∑–ª–µ
    function showNodeInfo(node) {
      const depthNames = currentLanguage === 'ru' 
        ? ["–ê—Ç–∞", "–ñ—É–∑", "–†—É", "–¢–∞–π–ø–∞", "–†—É", "–ê—Ç–∞", "–ë–∞–ª–∞"]
        : ["–ê—Ç–∞", "–ñ“Ø–∑", "–†—É", "–¢–∞–π–ø–∞", "–†—É", "–ê—Ç–∞", "–ë–∞–ª–∞"];
      
      const depthName = depthNames[Math.min(node.depth, depthNames.length - 1)];
      
      const info = `
        ${currentLanguage === 'ru' ? '–í—ã–±—Ä–∞–Ω–æ:' : '–¢–∞“£–¥–∞–ª–¥—ã:'} <strong>${node.data.name}</strong>
        ${currentLanguage === 'ru' ? '–£—Ä–æ–≤–µ–Ω—å:' : '–î–µ“£–≥–µ–π:'} ${depthName} (${node.depth})
        ${node.children || node._children ? 
          (currentLanguage === 'ru' ? `–î–µ—Ç–µ–π:` : `–ë–∞–ª–∞–ª–∞—Ä—ã:`) + ` ${(node.children || node._children).length}` : 
          (currentLanguage === 'ru' ? '–ö–æ–Ω–µ—á–Ω—ã–π —É–∑–µ–ª' : '–°–æ“£“ì—ã —Ç“Ø–π—ñ–Ω')}
      `;
      
      console.log(info);
    }

    // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –¥–µ—Ä–µ–≤–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
    setTimeout(() => {
      const initialTransform = d3.zoomIdentity
        .translate(width / 2 - 60, height / 2 - 120)
        .scale(1.0);
      svg.call(zoom.transform, initialTransform);
    }, 100);
  }

  // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ü–û–î–°–í–ï–¢–ö–ò –£–ó–õ–ê
  function highlightNode(nodeName) {
    // –°–Ω–∏–º–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å–æ –≤—Å–µ—Ö —É–∑–ª–æ–≤
    d3.selectAll(".node-card").classed("highlighted", false);
    
    // –ù–∞—Ö–æ–¥–∏–º –Ω—É–∂–Ω—ã–π —É–∑–µ–ª
    function findAndHighlight(node, targetName) {
      if (node.data.name === targetName) {
        // –ù–∞—Ö–æ–¥–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç SVG
        const nodeElement = d3.selectAll(".node-group").filter((d, i, nodes) => {
          return d.data.name === targetName;
        });
        
        if (nodeElement.size() > 0) {
          // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º —É–∑–µ–ª
          nodeElement.select(".node-card").classed("highlighted", true);
          
          // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –¥–µ—Ä–µ–≤–æ –Ω–∞ —ç—Ç–æ–º —É–∑–ª–µ
          const transform = d3.zoomIdentity
            .translate(window.innerWidth / 2 - node.x, window.innerHeight / 2 - node.y)
            .scale(1.5);
          
          svg.transition().duration(1000).call(zoom.transform, transform);
          
          return node;
        }
      }
      
      if (node.children) {
        for (let child of node.children) {
          const found = findAndHighlight(child, targetName);
          if (found) return found;
        }
      }
      
      return null;
    }
    
    return findAndHighlight(treeRoot, nodeName);
  }

  // ========== –ü–û–ò–°–ö ==========
  function searchInTree(query) {
    const results = [];
    const searchLower = query.toLowerCase();
    
    function traverse(node, path = []) {
      if (node.data && node.data.name.toLowerCase().includes(searchLower)) {
        results.push({
          name: node.data.name,
          path: [...path, node.data.name].join(' ‚Üí '),
          node: node
        });
      }
      
      if (node.children) {
        node.children.forEach(child => traverse(child, [...path, node.data.name]));
      }
      if (node._children) {
        node._children.forEach(child => traverse(child, [...path, node.data.name]));
      }
    }
    
    const root = d3.hierarchy(currentTreeData);
    traverse(root);
    return results;
  }

  const searchInput = document.querySelector('.search-box');
  const resultsList = document.getElementById('search-results-list');
  
  searchInput.addEventListener('input', function() {
    const query = this.value.trim();
    
    if (query.length < 2) {
      resultsList.innerHTML = `<p>${translations[currentLanguage].search.minChars}</p>`;
      return;
    }
    
    const results = searchInTree(query);
    
    if (results.length === 0) {
      resultsList.innerHTML = `<p>${translations[currentLanguage].search.noResults}</p>`;
      return;
    }
    
    let html = `<p>${translations[currentLanguage].search.found.replace('{count}', results.length)}</p>`;
    results.forEach(result => {
      html += `
        <div class="result-item" data-name="${result.name}">
          <strong>${result.name}</strong>
          <div style="font-size: 12px; color: #666;">${result.path}</div>
        </div>
      `;
    });
    
    resultsList.innerHTML = html;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–∞
    document.querySelectorAll('.result-item').forEach(item => {
      item.addEventListener('click', function() {
        const name = this.getAttribute('data-name');
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –¥–µ—Ä–µ–≤–æ
        icons.forEach(i => i.classList.remove('active'));
        document.querySelector('[data-section="people"]').classList.add('active');
        
        sections.forEach(s => s.classList.remove('active'));
        document.getElementById('people-section').classList.add('active');
        
        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —É–∑–µ–ª
        setTimeout(() => {
          highlightNode(name);
          showNotification(translations[currentLanguage].alerts.goTo.replace('{name}', name));
        }, 100);
      });
    });
  });

  // ========== –î–û–ë–ê–í–õ–ï–ù–ò–ï ==========
  function updateParentSelect() {
    const select = document.getElementById('parent-select');
    select.innerHTML = `<option value="">${translations[currentLanguage].add.selectParent}</option>`;
    
    function addOptions(node, depth = 0) {
      const indent = '‚Äî '.repeat(depth);
      select.innerHTML += `<option value="${node.name}">${indent}${node.name}</option>`;
      
      if (node.children) {
        node.children.forEach(child => addOptions(child, depth + 1));
      }
    }
    
    addOptions(currentTreeData);
  }

  // –û–¢–ü–†–ê–í–ö–ê –ó–ê–Ø–í–ö–ò
  document.getElementById('submit-request-btn').addEventListener('click', function() {
    const name = document.getElementById('person-name').value;
    const parent = document.getElementById('parent-select').value;
    const info = document.getElementById('person-info').value;
    const email = document.getElementById('person-email').value;
    const t = translations[currentLanguage];
    
    if (!name) {
      showNotification(t.alerts.enterName, true);
      return;
    }
    
    if (!parent) {
      showNotification(t.alerts.selectParent, true);
      return;
    }
    
    if (!email) {
      showNotification(t.alerts.enterEmail, true);
      return;
    }
    
    const request = {
      name: name,
      parent: parent,
      info: info,
      email: email
    };
    
    try {
      addRequest(request);
      showNotification(t.alerts.requestSent);
      
      // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
      document.getElementById('person-name').value = '';
      document.getElementById('parent-select').value = '';
      document.getElementById('person-info').value = '';
      document.getElementById('person-email').value = '';
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      updateStatistics();
      
    } catch (error) {
      console.error(error);
      showNotification(t.alerts.requestError, true);
    }
  });

  // ========== –°–ò–°–¢–ï–ú–ê –ó–ê–Ø–í–û–ö ==========
  let isAdminLoggedIn = false;

  function checkAdminAccess() {
    if (!isAdminLoggedIn) {
      const password = prompt(translations[currentLanguage].alerts.adminPassword);
      
      if (password === ADMIN_PASSWORD) {
        isAdminLoggedIn = true;
        showNotification(translations[currentLanguage].alerts.loginSuccess);
        loadRequests();
      } else {
        showNotification(translations[currentLanguage].alerts.wrongPassword, true);
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –¥–µ—Ä–µ–≤–æ
        icons.forEach(i => i.classList.remove('active'));
        document.querySelector('[data-section="people"]').classList.add('active');
        
        sections.forEach(s => s.classList.remove('active'));
        document.getElementById('people-section').classList.add('active');
      }
    } else {
      loadRequests();
    }
  }

  function loadRequests() {
    const requests = getRequests();
    const requestsList = document.getElementById('requests-list');
    const t = translations[currentLanguage];
    
    if (requests.length === 0) {
      requestsList.innerHTML = `<p style="text-align: center; color: #888;">${t.requests.noRequests}</p>`;
      return;
    }
    
    let html = '';
    requests.forEach(request => {
      if (request.status === 'pending') {
        html += `
          <div class="request-item" data-id="${request.id}">
            <div class="request-header">
              <div class="request-name">${request.name}</div>
              <div class="request-date">${t.requests.date} ${request.date}</div>
            </div>
            <div class="request-details">
              <div><strong>${t.requests.parent}:</strong> ${request.parent}</div>
              ${request.info ? `<div><strong>${t.requests.info}:</strong> ${request.info}</div>` : ''}
              <div><strong>${t.requests.email}:</strong> ${request.email}</div>
            </div>
            <div class="request-actions">
              <button class="action-btn approve-btn" onclick="handleApprove(${request.id})">
                ${t.requests.approve}
              </button>
              <button class="action-btn reject-btn" onclick="handleReject(${request.id})">
                ${t.requests.reject}
              </button>
            </div>
          </div>
        `;
      }
    });
    
    requestsList.innerHTML = html;
    updateStatistics();
  }

  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫
  window.handleApprove = function(requestId) {
    if (approveRequest(requestId)) {
      showNotification(translations[currentLanguage].alerts.approved);
      loadRequests();
      updateStatistics();
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ä–µ–≤–æ
      if (document.getElementById('people-section').classList.contains('active')) {
        initTree();
      }
    }
  };

  window.handleReject = function(requestId) {
    if (rejectRequest(requestId)) {
      showNotification(translations[currentLanguage].alerts.rejected);
      loadRequests();
      updateStatistics();
    }
  };

  // –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∞
  document.querySelector('.admin-btn').addEventListener('click', function() {
    if (isAdminLoggedIn) {
      isAdminLoggedIn = false;
      showNotification(translations[currentLanguage].alerts.logout);
      
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –¥–µ—Ä–µ–≤–æ
      icons.forEach(i => i.classList.remove('active'));
      document.querySelector('[data-section="people"]').classList.add('active');
      
      sections.forEach(s => s.classList.remove('active'));
      document.getElementById('people-section').classList.add('active');
    } else {
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∑–∞—è–≤–∫–∏ (–±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω –ø–∞—Ä–æ–ª—å)
      icons.forEach(i => i.classList.remove('active'));
      document.querySelector('[data-section="requests"]').classList.add('active');
      
      sections.forEach(s => s.classList.remove('active'));
      document.getElementById('requests-section').classList.add('active');
    }
  });

  // ========== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ==========
  function updateStatistics() {
    function countNodes(node) {
      let total = 1;
      let leaves = 0;
      let maxDepth = 0;
      
      function traverse(n, depth = 0) {
        maxDepth = Math.max(maxDepth, depth);
        
        const hasChildren = (n.children && n.children.length > 0) || 
                          (n._children && n._children.length > 0);
        
        if (!hasChildren) {
          leaves++;
        }
        
        if (n.children) {
          n.children.forEach(child => {
            total++;
            traverse(child, depth + 1);
          });
        }
        if (n._children) {
          n._children.forEach(child => {
            total++;
            traverse(child, depth + 1);
          });
        }
      }
      
      traverse(node);
      
      return {
        total,
        leaves,
        maxDepth,
        branches: node.children ? node.children.length : 0
      };
    }
    
    const root = d3.hierarchy(currentTreeData);
    const stats = countNodes(root);
    const requests = getRequests();
    const approved = getApproved();
    
    document.getElementById('total-people').textContent = stats.total;
    document.getElementById('total-levels').textContent = stats.maxDepth + 1;
    document.getElementById('total-branches').textContent = stats.branches;
    document.getElementById('total-leaves').textContent = stats.leaves;
    document.getElementById('total-requests').textContent = requests.filter(r => r.status === 'pending').length;
    document.getElementById('total-approved').textContent = approved.length;
  }

  // ========== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==========
  function showNotification(message, isError = false) {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.className = 'notification' + (isError ? ' error' : '');
    notification.style.display = 'block';
    
    setTimeout(() => {
      notification.style.display = 'none';
    }, 3000);
  }

  // ========== –ö–ù–û–ü–ö–ê + ==========
  document.querySelector('.floating-btn').addEventListener('click', function() {
    icons.forEach(i => i.classList.remove('active'));
    document.querySelector('[data-section="add"]').classList.add('active');
    
    sections.forEach(s => s.classList.remove('active'));
    document.getElementById('add-section').classList.add('active');
    
    updateParentSelect();
  });

  // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ==========
  document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    initStorage();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
    initTree();
    updateStatistics();
    updateParentSelect();
    translatePage();
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    window.addEventListener('resize', function() {
      if (document.getElementById('people-section').classList.contains('active')) {
        setTimeout(initTree, 100);
      }
    });
  });
</script>
</body>
</html>
